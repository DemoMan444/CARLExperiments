[2025-12-12 18:31:13] Initialized run directory: logs/mario_benchmark/inertia_1212_1831
[2025-12-12 18:31:13] Generating training contexts (varying only mario_inertia)...
[2025-12-12 18:31:13] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-12 18:31:13] Using context keys in observations: ['mario_inertia']
[2025-12-12 18:31:13] Training contexts (all):
[2025-12-12 18:31:13]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 43, 'mario_state': 0, 'mario_inertia': 0.8115054566389779}
[2025-12-12 18:31:13]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 43, 'mario_state': 0, 'mario_inertia': 1.1609066539279482}
[2025-12-12 18:31:13]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 44, 'mario_state': 0, 'mario_inertia': 0.8133390964185989}
[2025-12-12 18:31:13]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 44, 'mario_state': 0, 'mario_inertia': 1.1240589619965349}
[2025-12-12 18:31:13]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 45, 'mario_state': 0, 'mario_inertia': 0.832713905581114}
[2025-12-12 18:31:13]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 45, 'mario_state': 0, 'mario_inertia': 1.1859137490948597}
[2025-12-12 18:31:13]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 46, 'mario_state': 0, 'mario_inertia': 0.8666090213098026}
[2025-12-12 18:31:13]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 46, 'mario_state': 0, 'mario_inertia': 1.1541162212283405}
[2025-12-12 18:31:13]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 47, 'mario_state': 0, 'mario_inertia': 0.802901382442436}
[2025-12-12 18:31:13]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 47, 'mario_state': 0, 'mario_inertia': 1.1733748296280282}
[2025-12-12 18:31:13] Test contexts (all):
[2025-12-12 18:31:13]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10043, 'mario_state': 0, 'mario_inertia': 0.5, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.500
[2025-12-12 18:31:13]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10043, 'mario_state': 0, 'mario_inertia': 0.55, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.550
[2025-12-12 18:31:13]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10043, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-12 18:31:13]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10043, 'mario_state': 0, 'mario_inertia': 0.7, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.700
[2025-12-12 18:31:13]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10043, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-12 18:31:13]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10043, 'mario_state': 0, 'mario_inertia': 1.1, 'gen_type': 'id'} --> gen_type=id, inertia=1.100
[2025-12-12 18:31:13]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10044, 'mario_state': 0, 'mario_inertia': 0.5, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.500
[2025-12-12 18:31:13]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10044, 'mario_state': 0, 'mario_inertia': 0.55, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.550
[2025-12-12 18:31:13]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10044, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-12 18:31:13]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10044, 'mario_state': 0, 'mario_inertia': 0.7, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.700
[2025-12-12 18:31:13]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10044, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-12 18:31:13]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10044, 'mario_state': 0, 'mario_inertia': 1.1, 'gen_type': 'id'} --> gen_type=id, inertia=1.100
[2025-12-12 18:31:13]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10045, 'mario_state': 0, 'mario_inertia': 0.5, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.500
[2025-12-12 18:31:13]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10045, 'mario_state': 0, 'mario_inertia': 0.55, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.550
[2025-12-12 18:31:13]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10045, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-12 18:31:13]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10045, 'mario_state': 0, 'mario_inertia': 0.7, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.700
[2025-12-12 18:31:13]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10045, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-12 18:31:13]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10045, 'mario_state': 0, 'mario_inertia': 1.1, 'gen_type': 'id'} --> gen_type=id, inertia=1.100
[2025-12-12 18:31:13]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10046, 'mario_state': 0, 'mario_inertia': 0.5, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.500
[2025-12-12 18:31:13]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10046, 'mario_state': 0, 'mario_inertia': 0.55, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.550
[2025-12-12 18:31:13]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10046, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-12 18:31:13]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10046, 'mario_state': 0, 'mario_inertia': 0.7, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.700
[2025-12-12 18:31:13]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10046, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-12 18:31:13]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10046, 'mario_state': 0, 'mario_inertia': 1.1, 'gen_type': 'id'} --> gen_type=id, inertia=1.100
[2025-12-12 18:31:13]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10047, 'mario_state': 0, 'mario_inertia': 0.5, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.500
[2025-12-12 18:31:13]   id=25: {'level_width': 100, 'level_index': 0, 'noise_seed': 10047, 'mario_state': 0, 'mario_inertia': 0.55, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.550
[2025-12-12 18:31:13]   id=26: {'level_width': 100, 'level_index': 0, 'noise_seed': 10047, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-12 18:31:13]   id=27: {'level_width': 100, 'level_index': 0, 'noise_seed': 10047, 'mario_state': 0, 'mario_inertia': 0.7, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.700
[2025-12-12 18:31:13]   id=28: {'level_width': 100, 'level_index': 0, 'noise_seed': 10047, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-12 18:31:13]   id=29: {'level_width': 100, 'level_index': 0, 'noise_seed': 10047, 'mario_state': 0, 'mario_inertia': 1.1, 'gen_type': 'id'} --> gen_type=id, inertia=1.100
[2025-12-12 18:31:13] Test contexts by type: {'id': 10, 'interp': 0, 'extra': 20}
[2025-12-12 18:31:13] Creating 8 parallel environments...
[2025-12-12 18:31:19] Creating evaluation environment...
[2025-12-12 18:31:19] Creating PPO model...
[2025-12-12 18:31:21] Training Configuration:
[2025-12-12 18:31:21]   Train contexts: 10
[2025-12-12 18:31:21]   Test contexts: 30
[2025-12-12 18:31:21]   Parallel envs: 8
[2025-12-12 18:31:21]   Seed: 42
[2025-12-12 18:31:21]   Level width: 100
[2025-12-12 18:31:21]   Total timesteps: 40,000
[2025-12-12 18:31:21]   Device: cpu
[2025-12-12 18:31:21]   Use context in obs: True
[2025-12-12 18:31:21]   Test on train maps: False
[2025-12-12 18:31:21]   Run Directory: logs/mario_benchmark/inertia_1212_1831
[2025-12-12 18:31:21] ==================================================
[2025-12-12 18:31:21] STARTING TRAINING
[2025-12-12 18:31:21] ==================================================
[2025-12-12 18:32:50] ----------------------------------------------------------------
[2025-12-12 18:32:50] Train @ 10,000 steps
[2025-12-12 18:32:50]   Episodes (total): 143
[2025-12-12 18:32:50]   Window(50) mean return (episode-weighted): 3.20 
[2025-12-12 18:32:50]   Window(50) mean length: 40.9
[2025-12-12 18:32:50]   Window(50) mean completion: 35.09%
[2025-12-12 18:32:50]   Uniform-per-context mean return: 2.46
[2025-12-12 18:32:50]   Uniform-per-context mean completion: 32.74%
[2025-12-12 18:32:50]   Context distribution (last 50 eps): 0:10% 1:10% 2:8% 3:8% 4:10% 5:10% 6:10% 7:12% 8:12% 9:10%
[2025-12-12 18:32:50] ----------------------------------------------------------------
[2025-12-12 18:33:47] ----------------------------------------------------------------
[2025-12-12 18:33:47] Train @ 20,000 steps
[2025-12-12 18:33:47]   Episodes (total): 321
[2025-12-12 18:33:47]   Window(50) mean return (episode-weighted): 2.92 ↓
[2025-12-12 18:33:47]   Window(50) mean length: 71.1
[2025-12-12 18:33:47]   Window(50) mean completion: 36.17%
[2025-12-12 18:33:47]   Uniform-per-context mean return: 2.81
[2025-12-12 18:33:47]   Uniform-per-context mean completion: 34.90%
[2025-12-12 18:33:47]   Context distribution (last 50 eps): 0:10% 1:8% 2:10% 3:10% 4:10% 5:10% 6:8% 7:10% 8:14% 9:10%
[2025-12-12 18:33:47] ----------------------------------------------------------------
[2025-12-12 18:33:47] Checkpoint saved at 20,000 steps to logs/mario_benchmark/inertia_1212_1831/checkpoints/ppo_inertia_20000.zip
[2025-12-12 18:35:31] ----------------------------------------------------------------
[2025-12-12 18:35:31] Train @ 30,000 steps
[2025-12-12 18:35:31]   Episodes (total): 494
[2025-12-12 18:35:31]   Window(50) mean return (episode-weighted): 3.58 ↑
[2025-12-12 18:35:31]   Window(50) mean length: 46.5
[2025-12-12 18:35:31]   Window(50) mean completion: 36.76%
[2025-12-12 18:35:31]   Uniform-per-context mean return: 2.91
[2025-12-12 18:35:31]   Uniform-per-context mean completion: 35.56%
[2025-12-12 18:35:31]   Context distribution (last 50 eps): 0:10% 1:10% 2:8% 3:8% 4:8% 5:8% 6:12% 7:14% 8:14% 9:8%
[2025-12-12 18:35:31] ----------------------------------------------------------------
[2025-12-12 18:36:55] ----------------------------------------------------------------
[2025-12-12 18:36:55] Train @ 40,000 steps
[2025-12-12 18:36:55]   Episodes (total): 676
[2025-12-12 18:36:55]   Window(50) mean return (episode-weighted): 3.58 →
[2025-12-12 18:36:55]   Window(50) mean length: 64.9
[2025-12-12 18:36:55]   Window(50) mean completion: 39.11%
[2025-12-12 18:36:55]   Uniform-per-context mean return: 3.21
[2025-12-12 18:36:55]   Uniform-per-context mean completion: 37.10%
[2025-12-12 18:36:55]   Context distribution (last 50 eps): 0:10% 1:12% 2:12% 3:12% 4:10% 5:10% 6:10% 7:6% 8:8% 9:10%
[2025-12-12 18:36:55] ----------------------------------------------------------------
[2025-12-12 18:36:55] Checkpoint saved at 40,000 steps to logs/mario_benchmark/inertia_1212_1831/checkpoints/ppo_inertia_40000.zip
[2025-12-12 18:37:05] Saved training curve to logs/mario_benchmark/inertia_1212_1831/training_curve.json
[2025-12-12 18:37:05] Saved episode history to logs/mario_benchmark/inertia_1212_1831/episode_history.json
[2025-12-12 18:37:05] ==================================================
[2025-12-12 18:37:05] FINAL EVALUATION
[2025-12-12 18:37:05] ==================================================
