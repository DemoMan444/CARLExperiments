[2025-12-13 16:26:21] Initialized run directory: logs/mario_inertia_full/multi_1213_153203/seed_3/inertia_1213_162621
[2025-12-13 16:26:21] Generating training contexts (varying only mario_inertia)...
[2025-12-13 16:26:21] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-13 16:26:21] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-13 16:26:21] Using context keys in observations: NONE (vision only)
[2025-12-13 16:26:21] Training contexts (all):
[2025-12-13 16:26:21]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 16:26:21]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 16:26:21]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 16:26:21]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 16:26:21]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 16:26:21]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 16:26:21]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 16:26:21]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 16:26:21]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 8, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 16:26:21]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 8, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 16:26:21] Test contexts (all):
[2025-12-13 16:26:21]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 16:26:21]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 16:26:21]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 16:26:21]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 16:26:21]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 16:26:21]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 16:26:21]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 16:26:21]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 16:26:21]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 16:26:21]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 16:26:21]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 16:26:21]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 16:26:21]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 16:26:21]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 16:26:21]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 16:26:21]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 16:26:21]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 16:26:21]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 16:26:21]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 16:26:21]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 16:26:21]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 16:26:21]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 16:26:21]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 16:26:21]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 16:26:21]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 16:26:21] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-13 16:26:21] Creating 8 parallel environments...
[2025-12-13 16:26:32] Creating evaluation environment...
[2025-12-13 16:26:32] Train final eval contexts: 100 (n_inertias=100)
[2025-12-13 16:26:32] Creating PPO model...
[2025-12-13 16:26:32] Training Configuration:
[2025-12-13 16:26:32]   Train contexts: 10
[2025-12-13 16:26:32]   Test contexts: 25
[2025-12-13 16:26:32]   Parallel envs: 8
[2025-12-13 16:26:32]   Seed: 3
[2025-12-13 16:26:32]   Level width: 100
[2025-12-13 16:26:32]   Total timesteps: 100,000
[2025-12-13 16:26:32]   Device: cpu
[2025-12-13 16:26:32]   Use context in obs: False
[2025-12-13 16:26:32]   Test on train maps: False
[2025-12-13 16:26:32]   Run Directory: logs/mario_inertia_full/multi_1213_153203/seed_3/inertia_1213_162621
[2025-12-13 16:26:32] ==================================================
[2025-12-13 16:26:32] STARTING TRAINING
[2025-12-13 16:26:32] ==================================================
[2025-12-13 16:27:46] ----------------------------------------------------------------
[2025-12-13 16:27:46] Train @ 10,000 steps
[2025-12-13 16:27:46]   Episodes (total): 157
[2025-12-13 16:27:46]   Window(50) mean return (episode-weighted): 2.72 
[2025-12-13 16:27:46]   Window(50) mean length: 59.5
[2025-12-13 16:27:46]   Window(50) mean completion: 28.99%
[2025-12-13 16:27:46]   Uniform-per-context mean return: 2.31
[2025-12-13 16:27:46]   Uniform-per-context mean completion: 25.17%
[2025-12-13 16:27:46]   Context distribution (last 50 eps): 0:10% 1:10% 2:8% 3:10% 4:10% 5:10% 6:12% 7:10% 8:10% 9:10%
[2025-12-13 16:27:46] ----------------------------------------------------------------
[2025-12-13 16:28:36] ----------------------------------------------------------------
[2025-12-13 16:28:36] Train @ 20,000 steps
[2025-12-13 16:28:36]   Episodes (total): 353
[2025-12-13 16:28:36]   Window(50) mean return (episode-weighted): 4.44 ↑
[2025-12-13 16:28:36]   Window(50) mean length: 51.5
[2025-12-13 16:28:36]   Window(50) mean completion: 40.91%
[2025-12-13 16:28:36]   Uniform-per-context mean return: 2.99
[2025-12-13 16:28:36]   Uniform-per-context mean completion: 30.79%
[2025-12-13 16:28:36]   Context distribution (last 50 eps): 0:10% 1:8% 2:8% 3:10% 4:10% 5:10% 6:10% 7:12% 8:12% 9:10%
[2025-12-13 16:28:36] ----------------------------------------------------------------
[2025-12-13 16:29:29] ----------------------------------------------------------------
[2025-12-13 16:29:29] Train @ 30,000 steps
[2025-12-13 16:29:29]   Episodes (total): 549
[2025-12-13 16:29:29]   Window(50) mean return (episode-weighted): 5.18 ↑
[2025-12-13 16:29:29]   Window(50) mean length: 41.7
[2025-12-13 16:29:29]   Window(50) mean completion: 43.04%
[2025-12-13 16:29:29]   Uniform-per-context mean return: 4.15
[2025-12-13 16:29:29]   Uniform-per-context mean completion: 37.59%
[2025-12-13 16:29:29]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:10% 4:12% 5:12% 6:8% 7:8% 8:10% 9:10%
[2025-12-13 16:29:29] ----------------------------------------------------------------
[2025-12-13 16:30:24] ----------------------------------------------------------------
[2025-12-13 16:30:24] Train @ 40,000 steps
[2025-12-13 16:30:24]   Episodes (total): 718
[2025-12-13 16:30:24]   Window(50) mean return (episode-weighted): 6.22 ↑
[2025-12-13 16:30:24]   Window(50) mean length: 34.5
[2025-12-13 16:30:24]   Window(50) mean completion: 49.42%
[2025-12-13 16:30:24]   Uniform-per-context mean return: 5.34
[2025-12-13 16:30:24]   Uniform-per-context mean completion: 44.96%
[2025-12-13 16:30:24]   Context distribution (last 50 eps): 0:12% 1:10% 2:10% 3:8% 4:10% 5:10% 6:10% 7:10% 8:10% 9:10%
[2025-12-13 16:30:24] ----------------------------------------------------------------
[2025-12-13 16:31:17] ----------------------------------------------------------------
[2025-12-13 16:31:17] Train @ 50,000 steps
[2025-12-13 16:31:17]   Episodes (total): 890
[2025-12-13 16:31:17]   Window(50) mean return (episode-weighted): 6.52 ↑
[2025-12-13 16:31:17]   Window(50) mean length: 51.6
[2025-12-13 16:31:17]   Window(50) mean completion: 51.66%
[2025-12-13 16:31:17]   Uniform-per-context mean return: 5.91
[2025-12-13 16:31:17]   Uniform-per-context mean completion: 49.44%
[2025-12-13 16:31:17]   Context distribution (last 50 eps): 0:12% 1:8% 2:8% 3:8% 4:8% 5:10% 6:10% 7:12% 8:12% 9:12%
[2025-12-13 16:31:17] ----------------------------------------------------------------
[2025-12-13 16:32:06] ----------------------------------------------------------------
[2025-12-13 16:32:06] Train @ 60,000 steps
[2025-12-13 16:32:06]   Episodes (total): 1,056
[2025-12-13 16:32:06]   Window(50) mean return (episode-weighted): 8.02 ↑
[2025-12-13 16:32:06]   Window(50) mean length: 61.8
[2025-12-13 16:32:06]   Window(50) mean completion: 59.46%
[2025-12-13 16:32:06]   Uniform-per-context mean return: 6.25
[2025-12-13 16:32:06]   Uniform-per-context mean completion: 52.61%
[2025-12-13 16:32:06]   Context distribution (last 50 eps): 0:8% 1:8% 2:10% 3:10% 4:10% 5:10% 6:10% 7:14% 8:10% 9:10%
[2025-12-13 16:32:06] ----------------------------------------------------------------
[2025-12-13 16:32:06] Checkpoint saved at 60,000 steps to logs/mario_inertia_full/multi_1213_153203/seed_3/inertia_1213_162621/checkpoints/ppo_inertia_60000.zip
[2025-12-13 16:33:03] ----------------------------------------------------------------
[2025-12-13 16:33:03] Train @ 70,000 steps
[2025-12-13 16:33:03]   Episodes (total): 1,231
[2025-12-13 16:33:03]   Window(50) mean return (episode-weighted): 6.48 ↓
[2025-12-13 16:33:03]   Window(50) mean length: 30.1
[2025-12-13 16:33:03]   Window(50) mean completion: 55.66%
[2025-12-13 16:33:03]   Uniform-per-context mean return: 6.48
[2025-12-13 16:33:03]   Uniform-per-context mean completion: 54.50%
[2025-12-13 16:33:03]   Context distribution (last 50 eps): 0:10% 1:6% 2:8% 3:12% 4:12% 5:12% 6:10% 7:10% 8:10% 9:10%
[2025-12-13 16:33:03] ----------------------------------------------------------------
[2025-12-13 16:34:04] ----------------------------------------------------------------
[2025-12-13 16:34:04] Train @ 80,000 steps
[2025-12-13 16:34:04]   Episodes (total): 1,415
[2025-12-13 16:34:04]   Window(50) mean return (episode-weighted): 6.46 ↓
[2025-12-13 16:34:04]   Window(50) mean length: 52.4
[2025-12-13 16:34:04]   Window(50) mean completion: 55.12%
[2025-12-13 16:34:04]   Uniform-per-context mean return: 6.59
[2025-12-13 16:34:04]   Uniform-per-context mean completion: 54.31%
[2025-12-13 16:34:04]   Context distribution (last 50 eps): 0:8% 1:6% 2:8% 3:10% 4:10% 5:14% 6:14% 7:12% 8:10% 9:8%
[2025-12-13 16:34:04] ----------------------------------------------------------------
[2025-12-13 16:35:12] ----------------------------------------------------------------
[2025-12-13 16:35:12] Train @ 90,000 steps
[2025-12-13 16:35:12]   Episodes (total): 1,592
[2025-12-13 16:35:12]   Window(50) mean return (episode-weighted): 7.94 ↑
[2025-12-13 16:35:12]   Window(50) mean length: 65.6
[2025-12-13 16:35:12]   Window(50) mean completion: 56.00%
[2025-12-13 16:35:12]   Uniform-per-context mean return: 6.70
[2025-12-13 16:35:12]   Uniform-per-context mean completion: 54.49%
[2025-12-13 16:35:12]   Context distribution (last 50 eps): 0:8% 1:8% 2:8% 3:8% 4:8% 5:14% 6:16% 7:10% 8:10% 9:10%
[2025-12-13 16:35:12] ----------------------------------------------------------------
[2025-12-13 16:36:21] ----------------------------------------------------------------
[2025-12-13 16:36:21] Train @ 100,000 steps
[2025-12-13 16:36:21]   Episodes (total): 1,755
[2025-12-13 16:36:21]   Window(50) mean return (episode-weighted): 7.30 ↓
[2025-12-13 16:36:21]   Window(50) mean length: 60.1
[2025-12-13 16:36:21]   Window(50) mean completion: 56.95%
[2025-12-13 16:36:21]   Uniform-per-context mean return: 6.79
[2025-12-13 16:36:21]   Uniform-per-context mean completion: 54.02%
[2025-12-13 16:36:21]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:10% 4:10% 5:8% 6:10% 7:10% 8:10% 9:12%
[2025-12-13 16:36:21] ----------------------------------------------------------------
[2025-12-13 16:36:35] Saved training curve to logs/mario_inertia_full/multi_1213_153203/seed_3/inertia_1213_162621/training_curve.json
[2025-12-13 16:36:35] Saved episode history to logs/mario_inertia_full/multi_1213_153203/seed_3/inertia_1213_162621/episode_history.json
[2025-12-13 16:36:35] ==================================================
[2025-12-13 16:36:35] FINAL EVALUATION
[2025-12-13 16:36:35] ==================================================
[2025-12-13 16:37:03] ==================================================
[2025-12-13 16:37:03] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-13 16:37:03] ==================================================
[2025-12-13 16:37:03] Mean Return: 6.84 ± 7.70
[2025-12-13 16:37:03] Mean Completion: 49.76% ± 38.26%
[2025-12-13 16:37:03] Success Rate (full level): 32.00%
[2025-12-13 16:37:03] Mean Episode Length: 13.1
[2025-12-13 16:37:03] Per generalization-type summary:
[2025-12-13 16:37:03]   extra: mean_return=5.74, mean_completion=44.04%, success_rate=26.00%, n_episodes=50
[2025-12-13 16:37:03]   id: mean_return=7.84, mean_completion=54.60%, success_rate=36.00%, n_episodes=50
[2025-12-13 16:37:03]   interp: mean_return=7.04, mean_completion=51.55%, success_rate=36.00%, n_episodes=25
[2025-12-13 16:37:03] Per-inertia summary:
[2025-12-13 16:37:03]   inertia=0.600: mean_return=5.88, mean_completion=46.42%, success_rate=28.00%, n_episodes=25
[2025-12-13 16:37:03]   inertia=0.850: mean_return=8.36, mean_completion=57.24%, success_rate=40.00%, n_episodes=25
[2025-12-13 16:37:03]   inertia=1.000: mean_return=7.04, mean_completion=51.55%, success_rate=36.00%, n_episodes=25
[2025-12-13 16:37:03]   inertia=1.150: mean_return=7.32, mean_completion=51.96%, success_rate=32.00%, n_episodes=25
[2025-12-13 16:37:03]   inertia=1.400: mean_return=5.60, mean_completion=41.65%, success_rate=24.00%, n_episodes=25
[2025-12-13 16:37:03] ==================================================
[2025-12-13 16:37:03] ==================================================
[2025-12-13 16:37:03] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-13 16:37:03] ==================================================
[2025-12-13 16:38:23] ==================================================
[2025-12-13 16:38:23] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-13 16:38:23] ==================================================
[2025-12-13 16:38:23] Mean Return: 7.69 ± 7.88
[2025-12-13 16:38:23] Mean Completion: 57.63% ± 37.06%
[2025-12-13 16:38:23] Success Rate (full level): 28.00%
[2025-12-13 16:38:23] Mean Episode Length: 49.3
[2025-12-13 16:38:23] Per-range summary (collapsed from per-inertia):
[2025-12-13 16:38:23]   range_0:0.800-0.900: mean_return=3.47, mean_completion=37.26%, success_rate=5.66%, n_episodes=53
[2025-12-13 16:38:23]   range_1:1.100-1.200: mean_return=12.45, mean_completion=80.60%, success_rate=53.19%, n_episodes=47
[2025-12-13 16:38:23] (Per-inertia details saved in JSON: 100 values)
[2025-12-13 16:38:23] ==================================================
[2025-12-13 16:38:23] Saved final results to logs/mario_inertia_full/multi_1213_153203/seed_3/inertia_1213_162621/final_results.json
[2025-12-13 16:38:23] Model saved to logs/mario_inertia_full/multi_1213_153203/seed_3/inertia_1213_162621/final_model.zip
[2025-12-13 16:38:24] ==================================================
[2025-12-13 16:38:24] SETTING UP TRAINING
[2025-12-13 16:38:24] ==================================================
