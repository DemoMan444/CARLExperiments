[2025-12-13 16:11:07] Initialized run directory: logs/mario_inertia_full/multi_1213_153203/seed_2/inertia_1213_161107
[2025-12-13 16:11:07] Generating training contexts (varying only mario_inertia)...
[2025-12-13 16:11:07] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-13 16:11:07] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-13 16:11:07] Using context keys in observations: NONE (vision only)
[2025-12-13 16:11:07] Training contexts (all):
[2025-12-13 16:11:07]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 16:11:07]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 16:11:07]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 16:11:07]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 16:11:07]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 16:11:07]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 16:11:07]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 16:11:07]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 16:11:07]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 16:11:07]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 16:11:07] Test contexts (all):
[2025-12-13 16:11:07]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 16:11:07]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 16:11:07]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 16:11:07]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 16:11:07]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 16:11:07]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 16:11:07]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 16:11:07]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 16:11:07]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 16:11:07]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 16:11:07]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 16:11:07]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 16:11:07]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 16:11:07]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 16:11:07]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 16:11:07]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 16:11:07]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 16:11:07]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 16:11:07]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 16:11:07]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 16:11:07]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 16:11:07]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 16:11:07]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 16:11:07]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 16:11:07]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 16:11:07] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-13 16:11:07] Creating 8 parallel environments...
[2025-12-13 16:11:24] Creating evaluation environment...
[2025-12-13 16:11:24] Train final eval contexts: 100 (n_inertias=100)
[2025-12-13 16:11:24] Creating PPO model...
[2025-12-13 16:11:24] Training Configuration:
[2025-12-13 16:11:24]   Train contexts: 10
[2025-12-13 16:11:24]   Test contexts: 25
[2025-12-13 16:11:24]   Parallel envs: 8
[2025-12-13 16:11:24]   Seed: 2
[2025-12-13 16:11:24]   Level width: 100
[2025-12-13 16:11:24]   Total timesteps: 100,000
[2025-12-13 16:11:24]   Device: cpu
[2025-12-13 16:11:24]   Use context in obs: False
[2025-12-13 16:11:24]   Test on train maps: False
[2025-12-13 16:11:24]   Run Directory: logs/mario_inertia_full/multi_1213_153203/seed_2/inertia_1213_161107
[2025-12-13 16:11:24] ==================================================
[2025-12-13 16:11:24] STARTING TRAINING
[2025-12-13 16:11:24] ==================================================
[2025-12-13 16:12:53] ----------------------------------------------------------------
[2025-12-13 16:12:53] Train @ 10,000 steps
[2025-12-13 16:12:53]   Episodes (total): 155
[2025-12-13 16:12:53]   Window(50) mean return (episode-weighted): 2.26 
[2025-12-13 16:12:53]   Window(50) mean length: 45.9
[2025-12-13 16:12:53]   Window(50) mean completion: 29.11%
[2025-12-13 16:12:53]   Uniform-per-context mean return: 2.55
[2025-12-13 16:12:53]   Uniform-per-context mean completion: 31.62%
[2025-12-13 16:12:53]   Context distribution (last 50 eps): 0:8% 1:12% 2:12% 3:12% 4:12% 5:12% 6:12% 7:12% 8:2% 9:6%
[2025-12-13 16:12:53] ----------------------------------------------------------------
[2025-12-13 16:13:54] ----------------------------------------------------------------
[2025-12-13 16:13:54] Train @ 20,000 steps
[2025-12-13 16:13:54]   Episodes (total): 305
[2025-12-13 16:13:54]   Window(50) mean return (episode-weighted): 5.26 ↑
[2025-12-13 16:13:54]   Window(50) mean length: 61.1
[2025-12-13 16:13:54]   Window(50) mean completion: 43.69%
[2025-12-13 16:13:54]   Uniform-per-context mean return: 3.53
[2025-12-13 16:13:54]   Uniform-per-context mean completion: 36.29%
[2025-12-13 16:13:54]   Context distribution (last 50 eps): 0:8% 1:10% 2:10% 3:10% 4:10% 5:8% 6:10% 7:12% 8:14% 9:8%
[2025-12-13 16:13:54] ----------------------------------------------------------------
[2025-12-13 16:15:01] ----------------------------------------------------------------
[2025-12-13 16:15:01] Train @ 30,000 steps
[2025-12-13 16:15:01]   Episodes (total): 470
[2025-12-13 16:15:01]   Window(50) mean return (episode-weighted): 4.58 ↓
[2025-12-13 16:15:01]   Window(50) mean length: 56.6
[2025-12-13 16:15:01]   Window(50) mean completion: 44.87%
[2025-12-13 16:15:01]   Uniform-per-context mean return: 4.14
[2025-12-13 16:15:01]   Uniform-per-context mean completion: 39.84%
[2025-12-13 16:15:01]   Context distribution (last 50 eps): 0:12% 1:12% 2:12% 3:10% 4:10% 5:10% 6:8% 7:8% 8:8% 9:10%
[2025-12-13 16:15:01] ----------------------------------------------------------------
[2025-12-13 16:16:07] ----------------------------------------------------------------
[2025-12-13 16:16:07] Train @ 40,000 steps
[2025-12-13 16:16:07]   Episodes (total): 615
[2025-12-13 16:16:07]   Window(50) mean return (episode-weighted): 6.64 ↑
[2025-12-13 16:16:07]   Window(50) mean length: 67.5
[2025-12-13 16:16:07]   Window(50) mean completion: 52.58%
[2025-12-13 16:16:07]   Uniform-per-context mean return: 5.18
[2025-12-13 16:16:07]   Uniform-per-context mean completion: 45.39%
[2025-12-13 16:16:07]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:8% 4:8% 5:10% 6:10% 7:8% 8:12% 9:14%
[2025-12-13 16:16:07] ----------------------------------------------------------------
[2025-12-13 16:17:11] ----------------------------------------------------------------
[2025-12-13 16:17:11] Train @ 50,000 steps
[2025-12-13 16:17:11]   Episodes (total): 821
[2025-12-13 16:17:11]   Window(50) mean return (episode-weighted): 5.28 ↓
[2025-12-13 16:17:11]   Window(50) mean length: 41.1
[2025-12-13 16:17:11]   Window(50) mean completion: 47.11%
[2025-12-13 16:17:11]   Uniform-per-context mean return: 6.11
[2025-12-13 16:17:11]   Uniform-per-context mean completion: 50.75%
[2025-12-13 16:17:11]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:12% 4:12% 5:8% 6:10% 7:10% 8:6% 9:12%
[2025-12-13 16:17:11] ----------------------------------------------------------------
[2025-12-13 16:18:06] ----------------------------------------------------------------
[2025-12-13 16:18:06] Train @ 60,000 steps
[2025-12-13 16:18:06]   Episodes (total): 1,015
[2025-12-13 16:18:06]   Window(50) mean return (episode-weighted): 8.44 ↑
[2025-12-13 16:18:06]   Window(50) mean length: 72.2
[2025-12-13 16:18:06]   Window(50) mean completion: 62.20%
[2025-12-13 16:18:06]   Uniform-per-context mean return: 6.50
[2025-12-13 16:18:06]   Uniform-per-context mean completion: 53.60%
[2025-12-13 16:18:06]   Context distribution (last 50 eps): 0:14% 1:12% 2:8% 3:8% 4:8% 5:8% 6:8% 7:8% 8:12% 9:14%
[2025-12-13 16:18:06] ----------------------------------------------------------------
[2025-12-13 16:18:06] Checkpoint saved at 60,000 steps to logs/mario_inertia_full/multi_1213_153203/seed_2/inertia_1213_161107/checkpoints/ppo_inertia_60000.zip
[2025-12-13 16:19:11] ----------------------------------------------------------------
[2025-12-13 16:19:11] Train @ 70,000 steps
[2025-12-13 16:19:11]   Episodes (total): 1,207
[2025-12-13 16:19:11]   Window(50) mean return (episode-weighted): 6.54 ↓
[2025-12-13 16:19:11]   Window(50) mean length: 49.1
[2025-12-13 16:19:11]   Window(50) mean completion: 53.18%
[2025-12-13 16:19:11]   Uniform-per-context mean return: 6.53
[2025-12-13 16:19:11]   Uniform-per-context mean completion: 53.82%
[2025-12-13 16:19:11]   Context distribution (last 50 eps): 0:8% 1:10% 2:10% 3:12% 4:12% 5:12% 6:12% 7:10% 8:6% 9:8%
[2025-12-13 16:19:11] ----------------------------------------------------------------
[2025-12-13 16:20:11] ----------------------------------------------------------------
[2025-12-13 16:20:11] Train @ 80,000 steps
[2025-12-13 16:20:11]   Episodes (total): 1,374
[2025-12-13 16:20:11]   Window(50) mean return (episode-weighted): 7.02 ↑
[2025-12-13 16:20:11]   Window(50) mean length: 53.3
[2025-12-13 16:20:11]   Window(50) mean completion: 56.73%
[2025-12-13 16:20:11]   Uniform-per-context mean return: 6.92
[2025-12-13 16:20:11]   Uniform-per-context mean completion: 55.18%
[2025-12-13 16:20:11]   Context distribution (last 50 eps): 0:14% 1:12% 2:12% 3:8% 4:8% 5:8% 6:8% 7:8% 8:12% 9:10%
[2025-12-13 16:20:11] ----------------------------------------------------------------
[2025-12-13 16:21:15] ----------------------------------------------------------------
[2025-12-13 16:21:15] Train @ 90,000 steps
[2025-12-13 16:21:15]   Episodes (total): 1,533
[2025-12-13 16:21:15]   Window(50) mean return (episode-weighted): 7.06 ↑
[2025-12-13 16:21:15]   Window(50) mean length: 68.9
[2025-12-13 16:21:15]   Window(50) mean completion: 57.00%
[2025-12-13 16:21:15]   Uniform-per-context mean return: 6.84
[2025-12-13 16:21:15]   Uniform-per-context mean completion: 54.62%
[2025-12-13 16:21:15]   Context distribution (last 50 eps): 0:12% 1:12% 2:10% 3:6% 4:8% 5:8% 6:8% 7:10% 8:12% 9:14%
[2025-12-13 16:21:15] ----------------------------------------------------------------
[2025-12-13 16:22:23] ----------------------------------------------------------------
[2025-12-13 16:22:23] Train @ 100,000 steps
[2025-12-13 16:22:23]   Episodes (total): 1,772
[2025-12-13 16:22:23]   Window(50) mean return (episode-weighted): 6.10 ↓
[2025-12-13 16:22:23]   Window(50) mean length: 43.9
[2025-12-13 16:22:23]   Window(50) mean completion: 52.54%
[2025-12-13 16:22:23]   Uniform-per-context mean return: 6.89
[2025-12-13 16:22:23]   Uniform-per-context mean completion: 55.66%
[2025-12-13 16:22:23]   Context distribution (last 50 eps): 0:10% 1:12% 2:12% 3:10% 4:8% 5:8% 6:8% 7:10% 8:12% 9:10%
[2025-12-13 16:22:23] ----------------------------------------------------------------
[2025-12-13 16:22:36] Saved training curve to logs/mario_inertia_full/multi_1213_153203/seed_2/inertia_1213_161107/training_curve.json
[2025-12-13 16:22:36] Saved episode history to logs/mario_inertia_full/multi_1213_153203/seed_2/inertia_1213_161107/episode_history.json
[2025-12-13 16:22:36] ==================================================
[2025-12-13 16:22:36] FINAL EVALUATION
[2025-12-13 16:22:36] ==================================================
[2025-12-13 16:25:26] ==================================================
[2025-12-13 16:25:26] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-13 16:25:26] ==================================================
[2025-12-13 16:25:26] Mean Return: 4.53 ± 5.82
[2025-12-13 16:25:26] Mean Completion: 40.32% ± 31.15%
[2025-12-13 16:25:26] Success Rate (full level): 16.00%
[2025-12-13 16:25:26] Mean Episode Length: 88.4
[2025-12-13 16:25:26] Per generalization-type summary:
[2025-12-13 16:25:26]   extra: mean_return=4.26, mean_completion=39.86%, success_rate=8.00%, n_episodes=50
[2025-12-13 16:25:26]   id: mean_return=4.04, mean_completion=36.58%, success_rate=20.00%, n_episodes=50
[2025-12-13 16:25:26]   interp: mean_return=6.04, mean_completion=48.70%, success_rate=24.00%, n_episodes=25
[2025-12-13 16:25:26] Per-inertia summary:
[2025-12-13 16:25:26]   inertia=0.600: mean_return=4.44, mean_completion=46.01%, success_rate=4.00%, n_episodes=25
[2025-12-13 16:25:26]   inertia=0.850: mean_return=3.92, mean_completion=34.96%, success_rate=20.00%, n_episodes=25
[2025-12-13 16:25:26]   inertia=1.000: mean_return=6.04, mean_completion=48.70%, success_rate=24.00%, n_episodes=25
[2025-12-13 16:25:26]   inertia=1.150: mean_return=4.16, mean_completion=38.21%, success_rate=20.00%, n_episodes=25
[2025-12-13 16:25:26]   inertia=1.400: mean_return=4.08, mean_completion=33.72%, success_rate=12.00%, n_episodes=25
[2025-12-13 16:25:26] ==================================================
[2025-12-13 16:25:26] ==================================================
[2025-12-13 16:25:26] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-13 16:25:26] ==================================================
[2025-12-13 16:26:21] ==================================================
[2025-12-13 16:26:21] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-13 16:26:21] ==================================================
[2025-12-13 16:26:21] Mean Return: 7.55 ± 7.69
[2025-12-13 16:26:21] Mean Completion: 57.68% ± 35.90%
[2025-12-13 16:26:21] Success Rate (full level): 26.00%
[2025-12-13 16:26:21] Mean Episode Length: 33.2
[2025-12-13 16:26:21] Per-range summary (collapsed from per-inertia):
[2025-12-13 16:26:21]   range_0:0.800-0.900: mean_return=5.35, mean_completion=43.40%, success_rate=16.33%, n_episodes=49
[2025-12-13 16:26:21]   range_1:1.100-1.200: mean_return=9.67, mean_completion=71.40%, success_rate=35.29%, n_episodes=51
[2025-12-13 16:26:21] (Per-inertia details saved in JSON: 100 values)
[2025-12-13 16:26:21] ==================================================
[2025-12-13 16:26:21] Saved final results to logs/mario_inertia_full/multi_1213_153203/seed_2/inertia_1213_161107/final_results.json
[2025-12-13 16:26:21] Model saved to logs/mario_inertia_full/multi_1213_153203/seed_2/inertia_1213_161107/final_model.zip
[2025-12-13 16:26:21] ==================================================
[2025-12-13 16:26:21] SETTING UP TRAINING
[2025-12-13 16:26:21] ==================================================
