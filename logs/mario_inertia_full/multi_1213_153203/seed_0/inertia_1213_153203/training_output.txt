[2025-12-13 15:32:03] Initialized run directory: logs/mario_inertia_full/multi_1213_153203/seed_0/inertia_1213_153203
[2025-12-13 15:32:03] Generating training contexts (varying only mario_inertia)...
[2025-12-13 15:32:03] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-13 15:32:03] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-13 15:32:03] Using context keys in observations: NONE (vision only)
[2025-12-13 15:32:03] Training contexts (all):
[2025-12-13 15:32:03]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 1, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 15:32:03]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 1, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 15:32:03]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 2, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 15:32:03]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 2, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 15:32:03]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 15:32:03]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 15:32:03]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 15:32:03]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 15:32:03]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 15:32:03]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 15:32:03] Test contexts (all):
[2025-12-13 15:32:03]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 15:32:03]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 15:32:03]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 15:32:03]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 15:32:03]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 15:32:03]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 15:32:03]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 15:32:03]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 15:32:03]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 15:32:03]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 15:32:03]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 15:32:03]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 15:32:03]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 15:32:03]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 15:32:03]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 15:32:03]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 15:32:03]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 15:32:03]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 15:32:03]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 15:32:03]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 15:32:03]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 15:32:03]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 15:32:03]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 15:32:03]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 15:32:03]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 15:32:03] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-13 15:32:03] Creating 8 parallel environments...
[2025-12-13 15:32:09] Creating evaluation environment...
[2025-12-13 15:32:09] Train final eval contexts: 100 (n_inertias=100)
[2025-12-13 15:32:09] Creating PPO model...
[2025-12-13 15:32:10] Training Configuration:
[2025-12-13 15:32:10]   Train contexts: 10
[2025-12-13 15:32:10]   Test contexts: 25
[2025-12-13 15:32:10]   Parallel envs: 8
[2025-12-13 15:32:10]   Seed: 0
[2025-12-13 15:32:10]   Level width: 100
[2025-12-13 15:32:10]   Total timesteps: 100,000
[2025-12-13 15:32:10]   Device: cpu
[2025-12-13 15:32:10]   Use context in obs: False
[2025-12-13 15:32:10]   Test on train maps: False
[2025-12-13 15:32:10]   Run Directory: logs/mario_inertia_full/multi_1213_153203/seed_0/inertia_1213_153203
[2025-12-13 15:32:10] ==================================================
[2025-12-13 15:32:10] STARTING TRAINING
[2025-12-13 15:32:10] ==================================================
[2025-12-13 15:33:37] ----------------------------------------------------------------
[2025-12-13 15:33:37] Train @ 10,000 steps
[2025-12-13 15:33:37]   Episodes (total): 239
[2025-12-13 15:33:37]   Window(50) mean return (episode-weighted): 4.02 
[2025-12-13 15:33:37]   Window(50) mean length: 31.5
[2025-12-13 15:33:37]   Window(50) mean completion: 34.46%
[2025-12-13 15:33:37]   Uniform-per-context mean return: 2.87
[2025-12-13 15:33:37]   Uniform-per-context mean completion: 30.22%
[2025-12-13 15:33:37]   Context distribution (last 50 eps): 0:12% 1:14% 2:14% 3:14% 4:8% 5:6% 6:6% 7:6% 8:10% 9:10%
[2025-12-13 15:33:37] ----------------------------------------------------------------
[2025-12-13 15:34:32] ----------------------------------------------------------------
[2025-12-13 15:34:32] Train @ 20,000 steps
[2025-12-13 15:34:32]   Episodes (total): 636
[2025-12-13 15:34:32]   Window(50) mean return (episode-weighted): 4.92 ↑
[2025-12-13 15:34:32]   Window(50) mean length: 28.0
[2025-12-13 15:34:32]   Window(50) mean completion: 44.37%
[2025-12-13 15:34:32]   Uniform-per-context mean return: 3.52
[2025-12-13 15:34:32]   Uniform-per-context mean completion: 34.74%
[2025-12-13 15:34:32]   Context distribution (last 50 eps): 0:12% 1:10% 2:12% 3:10% 4:12% 5:10% 6:8% 7:10% 8:8% 9:8%
[2025-12-13 15:34:32] ----------------------------------------------------------------
[2025-12-13 15:35:24] ----------------------------------------------------------------
[2025-12-13 15:35:24] Train @ 30,000 steps
[2025-12-13 15:35:24]   Episodes (total): 1,048
[2025-12-13 15:35:24]   Window(50) mean return (episode-weighted): 5.38 ↑
[2025-12-13 15:35:24]   Window(50) mean length: 21.8
[2025-12-13 15:35:24]   Window(50) mean completion: 48.11%
[2025-12-13 15:35:24]   Uniform-per-context mean return: 4.64
[2025-12-13 15:35:24]   Uniform-per-context mean completion: 42.52%
[2025-12-13 15:35:24]   Context distribution (last 50 eps): 0:6% 1:8% 2:10% 3:10% 4:14% 5:14% 6:14% 7:8% 8:8% 9:8%
[2025-12-13 15:35:24] ----------------------------------------------------------------
[2025-12-13 15:36:14] ----------------------------------------------------------------
[2025-12-13 15:36:14] Train @ 40,000 steps
[2025-12-13 15:36:14]   Episodes (total): 1,380
[2025-12-13 15:36:14]   Window(50) mean return (episode-weighted): 5.00 ↓
[2025-12-13 15:36:14]   Window(50) mean length: 28.0
[2025-12-13 15:36:14]   Window(50) mean completion: 44.43%
[2025-12-13 15:36:14]   Uniform-per-context mean return: 4.64
[2025-12-13 15:36:14]   Uniform-per-context mean completion: 42.50%
[2025-12-13 15:36:14]   Context distribution (last 50 eps): 0:4% 1:4% 2:10% 3:12% 4:16% 5:16% 6:16% 7:8% 8:8% 9:6%
[2025-12-13 15:36:14] ----------------------------------------------------------------
[2025-12-13 15:37:10] ----------------------------------------------------------------
[2025-12-13 15:37:10] Train @ 50,000 steps
[2025-12-13 15:37:10]   Episodes (total): 1,746
[2025-12-13 15:37:10]   Window(50) mean return (episode-weighted): 5.76 ↑
[2025-12-13 15:37:10]   Window(50) mean length: 53.4
[2025-12-13 15:37:10]   Window(50) mean completion: 51.14%
[2025-12-13 15:37:10]   Uniform-per-context mean return: 5.20
[2025-12-13 15:37:10]   Uniform-per-context mean completion: 44.89%
[2025-12-13 15:37:10]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:10% 4:10% 5:8% 6:8% 7:12% 8:12% 9:10%
[2025-12-13 15:37:10] ----------------------------------------------------------------
[2025-12-13 15:38:04] ----------------------------------------------------------------
[2025-12-13 15:38:04] Train @ 60,000 steps
[2025-12-13 15:38:04]   Episodes (total): 2,098
[2025-12-13 15:38:04]   Window(50) mean return (episode-weighted): 4.64 ↓
[2025-12-13 15:38:04]   Window(50) mean length: 27.7
[2025-12-13 15:38:04]   Window(50) mean completion: 45.10%
[2025-12-13 15:38:04]   Uniform-per-context mean return: 5.66
[2025-12-13 15:38:04]   Uniform-per-context mean completion: 48.86%
[2025-12-13 15:38:04]   Context distribution (last 50 eps): 0:10% 1:12% 2:12% 3:12% 4:8% 5:8% 6:8% 7:8% 8:10% 9:12%
[2025-12-13 15:38:04] ----------------------------------------------------------------
[2025-12-13 15:38:04] Checkpoint saved at 60,000 steps to logs/mario_inertia_full/multi_1213_153203/seed_0/inertia_1213_153203/checkpoints/ppo_inertia_60000.zip
[2025-12-13 15:39:14] ----------------------------------------------------------------
[2025-12-13 15:39:14] Train @ 70,000 steps
[2025-12-13 15:39:14]   Episodes (total): 2,454
[2025-12-13 15:39:14]   Window(50) mean return (episode-weighted): 5.74 ↑
[2025-12-13 15:39:14]   Window(50) mean length: 22.2
[2025-12-13 15:39:14]   Window(50) mean completion: 45.39%
[2025-12-13 15:39:14]   Uniform-per-context mean return: 5.49
[2025-12-13 15:39:14]   Uniform-per-context mean completion: 46.96%
[2025-12-13 15:39:14]   Context distribution (last 50 eps): 0:6% 1:8% 2:8% 3:8% 4:12% 5:12% 6:14% 7:10% 8:12% 9:10%
[2025-12-13 15:39:14] ----------------------------------------------------------------
[2025-12-13 15:40:20] ----------------------------------------------------------------
[2025-12-13 15:40:20] Train @ 80,000 steps
[2025-12-13 15:40:20]   Episodes (total): 2,922
[2025-12-13 15:40:20]   Window(50) mean return (episode-weighted): 6.32 ↑
[2025-12-13 15:40:20]   Window(50) mean length: 23.8
[2025-12-13 15:40:20]   Window(50) mean completion: 47.58%
[2025-12-13 15:40:20]   Uniform-per-context mean return: 5.56
[2025-12-13 15:40:20]   Uniform-per-context mean completion: 45.02%
[2025-12-13 15:40:20]   Context distribution (last 50 eps): 0:14% 1:12% 2:10% 3:8% 4:8% 5:10% 6:8% 7:8% 8:10% 9:12%
[2025-12-13 15:40:20] ----------------------------------------------------------------
[2025-12-13 15:41:22] ----------------------------------------------------------------
[2025-12-13 15:41:22] Train @ 90,000 steps
[2025-12-13 15:41:22]   Episodes (total): 3,318
[2025-12-13 15:41:22]   Window(50) mean return (episode-weighted): 7.10 ↑
[2025-12-13 15:41:22]   Window(50) mean length: 29.1
[2025-12-13 15:41:22]   Window(50) mean completion: 53.72%
[2025-12-13 15:41:22]   Uniform-per-context mean return: 5.61
[2025-12-13 15:41:22]   Uniform-per-context mean completion: 46.06%
[2025-12-13 15:41:22]   Context distribution (last 50 eps): 0:10% 1:8% 2:8% 3:8% 4:8% 5:14% 6:14% 7:12% 8:10% 9:8%
[2025-12-13 15:41:22] ----------------------------------------------------------------
[2025-12-13 15:42:38] ----------------------------------------------------------------
[2025-12-13 15:42:38] Train @ 100,000 steps
[2025-12-13 15:42:38]   Episodes (total): 3,761
[2025-12-13 15:42:38]   Window(50) mean return (episode-weighted): 4.82 ↓
[2025-12-13 15:42:38]   Window(50) mean length: 17.3
[2025-12-13 15:42:38]   Window(50) mean completion: 44.68%
[2025-12-13 15:42:38]   Uniform-per-context mean return: 5.93
[2025-12-13 15:42:38]   Uniform-per-context mean completion: 48.15%
[2025-12-13 15:42:38]   Context distribution (last 50 eps): 0:6% 1:12% 2:12% 3:12% 4:10% 5:12% 6:12% 7:10% 8:8% 9:6%
[2025-12-13 15:42:38] ----------------------------------------------------------------
[2025-12-13 15:42:51] Saved training curve to logs/mario_inertia_full/multi_1213_153203/seed_0/inertia_1213_153203/training_curve.json
[2025-12-13 15:42:51] Saved episode history to logs/mario_inertia_full/multi_1213_153203/seed_0/inertia_1213_153203/episode_history.json
[2025-12-13 15:42:51] ==================================================
[2025-12-13 15:42:51] FINAL EVALUATION
[2025-12-13 15:42:51] ==================================================
[2025-12-13 15:47:34] ==================================================
[2025-12-13 15:47:34] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-13 15:47:34] ==================================================
[2025-12-13 15:47:34] Mean Return: 5.89 ± 7.06
[2025-12-13 15:47:34] Mean Completion: 46.24% ± 34.43%
[2025-12-13 15:47:34] Success Rate (full level): 23.20%
[2025-12-13 15:47:34] Mean Episode Length: 146.1
[2025-12-13 15:47:34] Per generalization-type summary:
[2025-12-13 15:47:34]   extra: mean_return=7.18, mean_completion=48.88%, success_rate=34.00%, n_episodes=50
[2025-12-13 15:47:34]   id: mean_return=5.64, mean_completion=45.16%, success_rate=24.00%, n_episodes=50
[2025-12-13 15:47:34]   interp: mean_return=3.80, mean_completion=43.14%, success_rate=0.00%, n_episodes=25
[2025-12-13 15:47:34] Per-inertia summary:
[2025-12-13 15:47:34]   inertia=0.600: mean_return=7.80, mean_completion=47.66%, success_rate=40.00%, n_episodes=25
[2025-12-13 15:47:34]   inertia=0.850: mean_return=6.12, mean_completion=47.55%, success_rate=24.00%, n_episodes=25
[2025-12-13 15:47:34]   inertia=1.000: mean_return=3.80, mean_completion=43.14%, success_rate=0.00%, n_episodes=25
[2025-12-13 15:47:34]   inertia=1.150: mean_return=5.16, mean_completion=42.77%, success_rate=24.00%, n_episodes=25
[2025-12-13 15:47:34]   inertia=1.400: mean_return=6.56, mean_completion=50.10%, success_rate=28.00%, n_episodes=25
[2025-12-13 15:47:34] ==================================================
[2025-12-13 15:47:34] ==================================================
[2025-12-13 15:47:34] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-13 15:47:34] ==================================================
[2025-12-13 15:48:39] ==================================================
[2025-12-13 15:48:39] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-13 15:48:39] ==================================================
[2025-12-13 15:48:39] Mean Return: 6.23 ± 6.61
[2025-12-13 15:48:39] Mean Completion: 50.54% ± 32.03%
[2025-12-13 15:48:39] Success Rate (full level): 19.00%
[2025-12-13 15:48:39] Mean Episode Length: 40.6
[2025-12-13 15:48:39] Per-range summary (collapsed from per-inertia):
[2025-12-13 15:48:39]   range_0:0.800-0.900: mean_return=4.04, mean_completion=39.67%, success_rate=6.25%, n_episodes=48
[2025-12-13 15:48:39]   range_1:1.100-1.200: mean_return=8.25, mean_completion=60.57%, success_rate=30.77%, n_episodes=52
[2025-12-13 15:48:39] (Per-inertia details saved in JSON: 100 values)
[2025-12-13 15:48:39] ==================================================
[2025-12-13 15:48:39] Saved final results to logs/mario_inertia_full/multi_1213_153203/seed_0/inertia_1213_153203/final_results.json
[2025-12-13 15:48:39] Model saved to logs/mario_inertia_full/multi_1213_153203/seed_0/inertia_1213_153203/final_model.zip
[2025-12-13 15:48:39] ==================================================
[2025-12-13 15:48:39] SETTING UP TRAINING
[2025-12-13 15:48:39] ==================================================
