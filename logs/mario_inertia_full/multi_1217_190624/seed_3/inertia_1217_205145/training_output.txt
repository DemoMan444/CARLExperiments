[2025-12-17 20:51:45] Initialized run directory: logs/mario_inertia_full/multi_1217_190624/seed_3/inertia_1217_205145
[2025-12-17 20:51:45] Generating training contexts (varying only mario_inertia)...
[2025-12-17 20:51:45] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-17 20:51:45] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-17 20:51:45] Using context keys in observations: ['mario_inertia']
[2025-12-17 20:51:45] Training contexts (all):
[2025-12-17 20:51:45]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-17 20:51:45]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-17 20:51:45]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-17 20:51:45]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-17 20:51:45]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-17 20:51:45]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-17 20:51:45]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-17 20:51:45]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-17 20:51:45]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 8, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-17 20:51:45]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 8, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-17 20:51:45] Test contexts (all):
[2025-12-17 20:51:45]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-17 20:51:45]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-17 20:51:45]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-17 20:51:45]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-17 20:51:45]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-17 20:51:45]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-17 20:51:45]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-17 20:51:45]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-17 20:51:45]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-17 20:51:45]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-17 20:51:45]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-17 20:51:45]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-17 20:51:45]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-17 20:51:45]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-17 20:51:45]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-17 20:51:45]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-17 20:51:45]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-17 20:51:45]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-17 20:51:45]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-17 20:51:45]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-17 20:51:45]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-17 20:51:45]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-17 20:51:45]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-17 20:51:45]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-17 20:51:45]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-17 20:51:45] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-17 20:51:45] Creating 8 parallel environments...
[2025-12-17 20:52:17] Creating evaluation environment...
[2025-12-17 20:52:18] Train final eval contexts: 100 (n_inertias=100)
[2025-12-17 20:52:18] Creating PPO model...
[2025-12-17 20:52:18] Training Configuration:
[2025-12-17 20:52:18]   Train contexts: 10
[2025-12-17 20:52:18]   Test contexts: 25
[2025-12-17 20:52:18]   Parallel envs: 8
[2025-12-17 20:52:18]   Seed: 3
[2025-12-17 20:52:18]   Level width: 100
[2025-12-17 20:52:18]   Total timesteps: 200,000
[2025-12-17 20:52:18]   Device: cpu
[2025-12-17 20:52:18]   Use context in obs: True
[2025-12-17 20:52:18]   Context keys: ['mario_inertia']
[2025-12-17 20:52:18]   Feature fusion: gmu
[2025-12-17 20:52:18]   Test on train maps: False
[2025-12-17 20:52:18]   Run Directory: logs/mario_inertia_full/multi_1217_190624/seed_3/inertia_1217_205145
[2025-12-17 20:52:18] ==================================================
[2025-12-17 20:52:18] STARTING TRAINING
[2025-12-17 20:52:18] ==================================================
[2025-12-17 20:55:38] ----------------------------------------------------------------
[2025-12-17 20:55:38] Train @ 20,000 steps
[2025-12-17 20:55:38]   Episodes (total): 361
[2025-12-17 20:55:38]   Window(50) mean return (episode-weighted): 6.14 
[2025-12-17 20:55:38]   Window(50) mean length: 43.1
[2025-12-17 20:55:38]   Window(50) mean completion: 49.78%
[2025-12-17 20:55:38]   Uniform-per-context mean return: 3.70
[2025-12-17 20:55:38]   Uniform-per-context mean completion: 34.42%
[2025-12-17 20:55:38]   Context distribution (last 50 eps): 0:8% 1:10% 2:12% 3:10% 4:12% 5:12% 6:8% 7:10% 8:10% 9:8%
[2025-12-17 20:55:38] ----------------------------------------------------------------
[2025-12-17 20:58:34] ----------------------------------------------------------------
[2025-12-17 20:58:34] Train @ 40,000 steps
[2025-12-17 20:58:34]   Episodes (total): 790
[2025-12-17 20:58:34]   Window(50) mean return (episode-weighted): 6.60 ↑
[2025-12-17 20:58:34]   Window(50) mean length: 37.4
[2025-12-17 20:58:34]   Window(50) mean completion: 52.34%
[2025-12-17 20:58:34]   Uniform-per-context mean return: 6.24
[2025-12-17 20:58:34]   Uniform-per-context mean completion: 49.89%
[2025-12-17 20:58:34]   Context distribution (last 50 eps): 0:12% 1:10% 2:10% 3:8% 4:10% 5:10% 6:10% 7:10% 8:10% 9:10%
[2025-12-17 20:58:34] ----------------------------------------------------------------
[2025-12-17 21:01:46] ----------------------------------------------------------------
[2025-12-17 21:01:46] Train @ 60,000 steps
[2025-12-17 21:01:46]   Episodes (total): 1,331
[2025-12-17 21:01:46]   Window(50) mean return (episode-weighted): 5.44 ↓
[2025-12-17 21:01:46]   Window(50) mean length: 30.8
[2025-12-17 21:01:46]   Window(50) mean completion: 52.91%
[2025-12-17 21:01:46]   Uniform-per-context mean return: 6.19
[2025-12-17 21:01:46]   Uniform-per-context mean completion: 51.95%
[2025-12-17 21:01:46]   Context distribution (last 50 eps): 0:10% 1:10% 2:8% 3:8% 4:10% 5:8% 6:14% 7:8% 8:12% 9:12%
[2025-12-17 21:01:46] ----------------------------------------------------------------
[2025-12-17 21:04:33] ----------------------------------------------------------------
[2025-12-17 21:04:33] Train @ 80,000 steps
[2025-12-17 21:04:33]   Episodes (total): 1,918
[2025-12-17 21:04:33]   Window(50) mean return (episode-weighted): 7.12 ↑
[2025-12-17 21:04:33]   Window(50) mean length: 29.5
[2025-12-17 21:04:33]   Window(50) mean completion: 57.77%
[2025-12-17 21:04:33]   Uniform-per-context mean return: 6.94
[2025-12-17 21:04:33]   Uniform-per-context mean completion: 53.81%
[2025-12-17 21:04:33]   Context distribution (last 50 eps): 0:10% 1:8% 2:8% 3:8% 4:8% 5:8% 6:12% 7:12% 8:14% 9:12%
[2025-12-17 21:04:33] ----------------------------------------------------------------
[2025-12-17 21:08:04] ----------------------------------------------------------------
[2025-12-17 21:08:04] Train @ 100,000 steps
[2025-12-17 21:08:04]   Episodes (total): 2,570
[2025-12-17 21:08:04]   Window(50) mean return (episode-weighted): 7.04 ↓
[2025-12-17 21:08:04]   Window(50) mean length: 25.5
[2025-12-17 21:08:04]   Window(50) mean completion: 54.95%
[2025-12-17 21:08:04]   Uniform-per-context mean return: 7.16
[2025-12-17 21:08:04]   Uniform-per-context mean completion: 57.60%
[2025-12-17 21:08:04]   Context distribution (last 50 eps): 0:4% 1:12% 2:12% 3:12% 4:14% 5:14% 6:12% 7:10% 8:6% 9:4%
[2025-12-17 21:08:04] ----------------------------------------------------------------
[2025-12-17 21:09:39] Checkpoint saved at 110,000 steps to logs/mario_inertia_full/multi_1217_190624/seed_3/inertia_1217_205145/checkpoints/ppo_inertia_110000.zip
[2025-12-17 21:11:32] ----------------------------------------------------------------
[2025-12-17 21:11:32] Train @ 120,000 steps
[2025-12-17 21:11:32]   Episodes (total): 3,332
[2025-12-17 21:11:32]   Window(50) mean return (episode-weighted): 8.86 ↑
[2025-12-17 21:11:32]   Window(50) mean length: 31.1
[2025-12-17 21:11:32]   Window(50) mean completion: 60.67%
[2025-12-17 21:11:32]   Uniform-per-context mean return: 7.50
[2025-12-17 21:11:32]   Uniform-per-context mean completion: 57.86%
[2025-12-17 21:11:32]   Context distribution (last 50 eps): 0:10% 1:8% 2:10% 3:8% 4:8% 5:10% 6:10% 7:14% 8:12% 9:10%
[2025-12-17 21:11:32] ----------------------------------------------------------------
[2025-12-17 21:15:09] ----------------------------------------------------------------
[2025-12-17 21:15:09] Train @ 140,000 steps
[2025-12-17 21:15:09]   Episodes (total): 4,102
[2025-12-17 21:15:09]   Window(50) mean return (episode-weighted): 8.16 ↓
[2025-12-17 21:15:09]   Window(50) mean length: 24.4
[2025-12-17 21:15:09]   Window(50) mean completion: 58.44%
[2025-12-17 21:15:09]   Uniform-per-context mean return: 7.24
[2025-12-17 21:15:09]   Uniform-per-context mean completion: 59.00%
[2025-12-17 21:15:09]   Context distribution (last 50 eps): 0:6% 1:14% 2:16% 3:16% 4:16% 5:14% 6:10% 7:4% 8:2% 9:2%
[2025-12-17 21:15:09] ----------------------------------------------------------------
[2025-12-17 21:18:45] ----------------------------------------------------------------
[2025-12-17 21:18:45] Train @ 160,000 steps
[2025-12-17 21:18:45]   Episodes (total): 4,885
[2025-12-17 21:18:45]   Window(50) mean return (episode-weighted): 8.04 ↓
[2025-12-17 21:18:45]   Window(50) mean length: 25.9
[2025-12-17 21:18:45]   Window(50) mean completion: 59.67%
[2025-12-17 21:18:45]   Uniform-per-context mean return: 8.28
[2025-12-17 21:18:45]   Uniform-per-context mean completion: 60.67%
[2025-12-17 21:18:45]   Context distribution (last 50 eps): 0:12% 1:8% 2:10% 3:10% 4:8% 5:10% 6:8% 7:8% 8:14% 9:12%
[2025-12-17 21:18:45] ----------------------------------------------------------------
[2025-12-17 21:22:18] ----------------------------------------------------------------
[2025-12-17 21:22:18] Train @ 180,000 steps
[2025-12-17 21:22:18]   Episodes (total): 5,688
[2025-12-17 21:22:18]   Window(50) mean return (episode-weighted): 8.22 ↑
[2025-12-17 21:22:18]   Window(50) mean length: 24.8
[2025-12-17 21:22:18]   Window(50) mean completion: 58.37%
[2025-12-17 21:22:18]   Uniform-per-context mean return: 7.60
[2025-12-17 21:22:18]   Uniform-per-context mean completion: 59.79%
[2025-12-17 21:22:18]   Context distribution (last 50 eps): 0:8% 1:12% 2:12% 3:14% 4:14% 5:12% 6:8% 7:6% 8:6% 9:8%
[2025-12-17 21:22:18] ----------------------------------------------------------------
[2025-12-17 21:25:27] ----------------------------------------------------------------
[2025-12-17 21:25:27] Train @ 200,000 steps
[2025-12-17 21:25:27]   Episodes (total): 6,509
[2025-12-17 21:25:27]   Window(50) mean return (episode-weighted): 6.66 ↓
[2025-12-17 21:25:27]   Window(50) mean length: 30.3
[2025-12-17 21:25:27]   Window(50) mean completion: 58.45%
[2025-12-17 21:25:27]   Uniform-per-context mean return: 7.92
[2025-12-17 21:25:27]   Uniform-per-context mean completion: 59.69%
[2025-12-17 21:25:27]   Context distribution (last 50 eps): 0:10% 1:12% 2:12% 3:8% 4:10% 5:8% 6:12% 7:10% 8:8% 9:10%
[2025-12-17 21:25:27] ----------------------------------------------------------------
[2025-12-17 21:25:40] Saved training curve to logs/mario_inertia_full/multi_1217_190624/seed_3/inertia_1217_205145/training_curve.json
[2025-12-17 21:25:40] Saved episode history to logs/mario_inertia_full/multi_1217_190624/seed_3/inertia_1217_205145/episode_history.json
[2025-12-17 21:25:40] ==================================================
[2025-12-17 21:25:40] FINAL EVALUATION
[2025-12-17 21:25:40] ==================================================
[2025-12-17 21:26:10] ==================================================
[2025-12-17 21:26:10] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-17 21:26:10] ==================================================
[2025-12-17 21:26:10] Mean Return: 6.09 ± 7.16
[2025-12-17 21:26:10] Mean Completion: 47.04% ± 36.65%
[2025-12-17 21:26:10] Success Rate (full level): 25.60%
[2025-12-17 21:26:10] Mean Episode Length: 11.5
[2025-12-17 21:26:10] Per generalization-type summary:
[2025-12-17 21:26:10]   extra: mean_return=5.56, mean_completion=44.23%, success_rate=22.00%, n_episodes=50
[2025-12-17 21:26:10]   id: mean_return=6.98, mean_completion=49.53%, success_rate=32.00%, n_episodes=50
[2025-12-17 21:26:10]   interp: mean_return=5.36, mean_completion=47.70%, success_rate=20.00%, n_episodes=25
[2025-12-17 21:26:10] Per-inertia summary:
[2025-12-17 21:26:10]   inertia=0.600: mean_return=5.16, mean_completion=46.68%, success_rate=20.00%, n_episodes=25
[2025-12-17 21:26:10]   inertia=0.850: mean_return=7.28, mean_completion=50.52%, success_rate=36.00%, n_episodes=25
[2025-12-17 21:26:10]   inertia=1.000: mean_return=5.36, mean_completion=47.70%, success_rate=20.00%, n_episodes=25
[2025-12-17 21:26:10]   inertia=1.150: mean_return=6.68, mean_completion=48.54%, success_rate=28.00%, n_episodes=25
[2025-12-17 21:26:10]   inertia=1.400: mean_return=5.96, mean_completion=41.77%, success_rate=24.00%, n_episodes=25
[2025-12-17 21:26:10] ==================================================
[2025-12-17 21:26:10] ==================================================
[2025-12-17 21:26:10] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-17 21:26:10] ==================================================
[2025-12-17 21:26:56] ==================================================
[2025-12-17 21:26:56] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-17 21:26:56] ==================================================
[2025-12-17 21:26:56] Mean Return: 7.72 ± 8.02
[2025-12-17 21:26:56] Mean Completion: 58.63% ± 37.13%
[2025-12-17 21:26:56] Success Rate (full level): 28.00%
[2025-12-17 21:26:56] Mean Episode Length: 22.6
[2025-12-17 21:26:56] Per-range summary (collapsed from per-inertia):
[2025-12-17 21:26:56]   range_0:0.800-0.900: mean_return=5.15, mean_completion=43.70%, success_rate=15.09%, n_episodes=53
[2025-12-17 21:26:56]   range_1:1.100-1.200: mean_return=10.62, mean_completion=75.46%, success_rate=42.55%, n_episodes=47
[2025-12-17 21:26:56] (Per-inertia details saved in JSON: 100 values)
[2025-12-17 21:26:56] ==================================================
[2025-12-17 21:26:56] Saved final results to logs/mario_inertia_full/multi_1217_190624/seed_3/inertia_1217_205145/final_results.json
[2025-12-17 21:26:56] Model saved to logs/mario_inertia_full/multi_1217_190624/seed_3/inertia_1217_205145/final_model.zip
[2025-12-17 21:26:57] ==================================================
[2025-12-17 21:26:57] SETTING UP TRAINING
[2025-12-17 21:26:57] ==================================================
