[2025-12-13 14:21:40] Initialized run directory: logs/mario_inertia_full/multi_1213_131329/seed_4/inertia_1213_1421
[2025-12-13 14:21:40] Generating training contexts (varying only mario_inertia)...
[2025-12-13 14:21:40] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-13 14:21:40] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-13 14:21:40] Using context keys in observations: NONE (vision only)
[2025-12-13 14:21:40] Training contexts (all):
[2025-12-13 14:21:40]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 14:21:40]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 14:21:40]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 14:21:40]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 14:21:40]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 14:21:40]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 14:21:40]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 8, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 14:21:40]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 8, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 14:21:40]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 9, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 14:21:40]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 9, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 14:21:40] Test contexts (all):
[2025-12-13 14:21:40]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 14:21:40]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 14:21:40]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 14:21:40]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 14:21:40]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 14:21:40]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 14:21:40]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 14:21:40]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 14:21:40]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 14:21:40]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 14:21:40]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 14:21:40]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 14:21:40]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 14:21:40]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 14:21:40]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 14:21:40]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 14:21:40]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 14:21:40]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 14:21:40]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 14:21:40]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 14:21:40]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10009, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 14:21:40]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10009, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 14:21:40]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10009, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 14:21:40]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10009, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 14:21:40]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10009, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 14:21:40] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-13 14:21:40] Creating 8 parallel environments...
[2025-12-13 14:21:59] Creating evaluation environment...
[2025-12-13 14:21:59] Train final eval contexts: 100 (n_inertias=100)
[2025-12-13 14:21:59] Creating PPO model...
[2025-12-13 14:21:59] Training Configuration:
[2025-12-13 14:21:59]   Train contexts: 10
[2025-12-13 14:21:59]   Test contexts: 25
[2025-12-13 14:21:59]   Parallel envs: 8
[2025-12-13 14:21:59]   Seed: 4
[2025-12-13 14:21:59]   Level width: 100
[2025-12-13 14:21:59]   Total timesteps: 100,000
[2025-12-13 14:21:59]   Device: cpu
[2025-12-13 14:21:59]   Use context in obs: False
[2025-12-13 14:21:59]   Test on train maps: False
[2025-12-13 14:21:59]   Run Directory: logs/mario_inertia_full/multi_1213_131329/seed_4/inertia_1213_1421
[2025-12-13 14:21:59] ==================================================
[2025-12-13 14:21:59] STARTING TRAINING
[2025-12-13 14:21:59] ==================================================
[2025-12-13 14:23:24] ----------------------------------------------------------------
[2025-12-13 14:23:24] Train @ 10,000 steps
[2025-12-13 14:23:24]   Episodes (total): 122
[2025-12-13 14:23:24]   Window(50) mean return (episode-weighted): 5.08 
[2025-12-13 14:23:24]   Window(50) mean length: 78.9
[2025-12-13 14:23:24]   Window(50) mean completion: 38.50%
[2025-12-13 14:23:24]   Uniform-per-context mean return: 3.90
[2025-12-13 14:23:24]   Uniform-per-context mean completion: 33.58%
[2025-12-13 14:23:24]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:10% 4:10% 5:8% 6:8% 7:8% 8:14% 9:12%
[2025-12-13 14:23:24] ----------------------------------------------------------------
[2025-12-13 14:24:17] ----------------------------------------------------------------
[2025-12-13 14:24:17] Train @ 20,000 steps
[2025-12-13 14:24:17]   Episodes (total): 270
[2025-12-13 14:24:17]   Window(50) mean return (episode-weighted): 5.40 ↑
[2025-12-13 14:24:17]   Window(50) mean length: 54.0
[2025-12-13 14:24:17]   Window(50) mean completion: 43.63%
[2025-12-13 14:24:17]   Uniform-per-context mean return: 4.50
[2025-12-13 14:24:17]   Uniform-per-context mean completion: 39.36%
[2025-12-13 14:24:17]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:14% 4:10% 5:10% 6:8% 7:8% 8:10% 9:10%
[2025-12-13 14:24:17] ----------------------------------------------------------------
[2025-12-13 14:25:10] ----------------------------------------------------------------
[2025-12-13 14:25:10] Train @ 30,000 steps
[2025-12-13 14:25:10]   Episodes (total): 393
[2025-12-13 14:25:10]   Window(50) mean return (episode-weighted): 7.20 ↑
[2025-12-13 14:25:10]   Window(50) mean length: 70.0
[2025-12-13 14:25:10]   Window(50) mean completion: 54.39%
[2025-12-13 14:25:10]   Uniform-per-context mean return: 5.18
[2025-12-13 14:25:10]   Uniform-per-context mean completion: 43.05%
[2025-12-13 14:25:10]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:10% 4:12% 5:10% 6:10% 7:10% 8:10% 9:8%
[2025-12-13 14:25:10] ----------------------------------------------------------------
[2025-12-13 14:26:03] ----------------------------------------------------------------
[2025-12-13 14:26:03] Train @ 40,000 steps
[2025-12-13 14:26:03]   Episodes (total): 484
[2025-12-13 14:26:03]   Window(50) mean return (episode-weighted): 6.48 ↓
[2025-12-13 14:26:03]   Window(50) mean length: 104.5
[2025-12-13 14:26:03]   Window(50) mean completion: 55.32%
[2025-12-13 14:26:03]   Uniform-per-context mean return: 5.52
[2025-12-13 14:26:03]   Uniform-per-context mean completion: 45.56%
[2025-12-13 14:26:03]   Context distribution (last 50 eps): 0:12% 1:12% 2:12% 3:12% 4:8% 5:6% 6:6% 7:8% 8:12% 9:12%
[2025-12-13 14:26:03] ----------------------------------------------------------------
[2025-12-13 14:27:03] ----------------------------------------------------------------
[2025-12-13 14:27:03] Train @ 50,000 steps
[2025-12-13 14:27:03]   Episodes (total): 657
[2025-12-13 14:27:03]   Window(50) mean return (episode-weighted): 5.30 ↓
[2025-12-13 14:27:03]   Window(50) mean length: 50.0
[2025-12-13 14:27:03]   Window(50) mean completion: 42.49%
[2025-12-13 14:27:03]   Uniform-per-context mean return: 5.86
[2025-12-13 14:27:03]   Uniform-per-context mean completion: 47.90%
[2025-12-13 14:27:03]   Context distribution (last 50 eps): 0:10% 1:8% 2:8% 3:8% 4:10% 5:12% 6:12% 7:14% 8:10% 9:8%
[2025-12-13 14:27:03] ----------------------------------------------------------------
[2025-12-13 14:28:00] ----------------------------------------------------------------
[2025-12-13 14:28:00] Train @ 60,000 steps
[2025-12-13 14:28:00]   Episodes (total): 787
[2025-12-13 14:28:00]   Window(50) mean return (episode-weighted): 7.50 ↑
[2025-12-13 14:28:00]   Window(50) mean length: 68.3
[2025-12-13 14:28:00]   Window(50) mean completion: 56.84%
[2025-12-13 14:28:00]   Uniform-per-context mean return: 6.16
[2025-12-13 14:28:00]   Uniform-per-context mean completion: 49.42%
[2025-12-13 14:28:00]   Context distribution (last 50 eps): 0:8% 1:8% 2:8% 3:8% 4:12% 5:10% 6:12% 7:12% 8:14% 9:8%
[2025-12-13 14:28:00] ----------------------------------------------------------------
[2025-12-13 14:28:00] Checkpoint saved at 60,000 steps to logs/mario_inertia_full/multi_1213_131329/seed_4/inertia_1213_1421/checkpoints/ppo_inertia_60000.zip
[2025-12-13 14:29:11] ----------------------------------------------------------------
[2025-12-13 14:29:11] Train @ 70,000 steps
[2025-12-13 14:29:11]   Episodes (total): 932
[2025-12-13 14:29:11]   Window(50) mean return (episode-weighted): 7.26 ↓
[2025-12-13 14:29:11]   Window(50) mean length: 83.7
[2025-12-13 14:29:11]   Window(50) mean completion: 56.62%
[2025-12-13 14:29:11]   Uniform-per-context mean return: 5.95
[2025-12-13 14:29:11]   Uniform-per-context mean completion: 49.16%
[2025-12-13 14:29:11]   Context distribution (last 50 eps): 0:8% 1:8% 2:8% 3:8% 4:14% 5:12% 6:12% 7:12% 8:10% 9:8%
[2025-12-13 14:29:11] ----------------------------------------------------------------
[2025-12-13 14:30:12] ----------------------------------------------------------------
[2025-12-13 14:30:12] Train @ 80,000 steps
[2025-12-13 14:30:12]   Episodes (total): 1,076
[2025-12-13 14:30:12]   Window(50) mean return (episode-weighted): 6.18 ↓
[2025-12-13 14:30:12]   Window(50) mean length: 57.0
[2025-12-13 14:30:12]   Window(50) mean completion: 48.81%
[2025-12-13 14:30:12]   Uniform-per-context mean return: 6.20
[2025-12-13 14:30:12]   Uniform-per-context mean completion: 50.54%
[2025-12-13 14:30:12]   Context distribution (last 50 eps): 0:12% 1:12% 2:12% 3:12% 4:6% 5:8% 6:8% 7:8% 8:10% 9:12%
[2025-12-13 14:30:12] ----------------------------------------------------------------
[2025-12-13 14:31:15] ----------------------------------------------------------------
[2025-12-13 14:31:15] Train @ 90,000 steps
[2025-12-13 14:31:15]   Episodes (total): 1,255
[2025-12-13 14:31:15]   Window(50) mean return (episode-weighted): 7.30 ↑
[2025-12-13 14:31:15]   Window(50) mean length: 66.0
[2025-12-13 14:31:15]   Window(50) mean completion: 59.79%
[2025-12-13 14:31:15]   Uniform-per-context mean return: 6.85
[2025-12-13 14:31:15]   Uniform-per-context mean completion: 54.28%
[2025-12-13 14:31:15]   Context distribution (last 50 eps): 0:12% 1:12% 2:12% 3:12% 4:10% 5:8% 6:8% 7:8% 8:6% 9:12%
[2025-12-13 14:31:15] ----------------------------------------------------------------
[2025-12-13 14:32:28] ----------------------------------------------------------------
[2025-12-13 14:32:28] Train @ 100,000 steps
[2025-12-13 14:32:28]   Episodes (total): 1,418
[2025-12-13 14:32:28]   Window(50) mean return (episode-weighted): 9.00 ↑
[2025-12-13 14:32:28]   Window(50) mean length: 58.1
[2025-12-13 14:32:28]   Window(50) mean completion: 63.43%
[2025-12-13 14:32:28]   Uniform-per-context mean return: 7.48
[2025-12-13 14:32:28]   Uniform-per-context mean completion: 56.37%
[2025-12-13 14:32:28]   Context distribution (last 50 eps): 0:8% 1:8% 2:10% 3:10% 4:10% 5:14% 6:12% 7:12% 8:10% 9:6%
[2025-12-13 14:32:28] ----------------------------------------------------------------
[2025-12-13 14:32:41] Saved training curve to logs/mario_inertia_full/multi_1213_131329/seed_4/inertia_1213_1421/training_curve.json
[2025-12-13 14:32:41] Saved episode history to logs/mario_inertia_full/multi_1213_131329/seed_4/inertia_1213_1421/episode_history.json
[2025-12-13 14:32:41] ==================================================
[2025-12-13 14:32:41] FINAL EVALUATION
[2025-12-13 14:32:41] ==================================================
[2025-12-13 14:33:11] ==================================================
[2025-12-13 14:33:11] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-13 14:33:11] ==================================================
[2025-12-13 14:33:11] Mean Return: 5.12 ± 7.02
[2025-12-13 14:33:11] Mean Completion: 39.93% ± 36.00%
[2025-12-13 14:33:11] Success Rate (full level): 21.60%
[2025-12-13 14:33:11] Mean Episode Length: 13.7
[2025-12-13 14:33:11] Per generalization-type summary:
[2025-12-13 14:33:11]   extra: mean_return=5.68, mean_completion=43.11%, success_rate=24.00%, n_episodes=50
[2025-12-13 14:33:11]   id: mean_return=4.40, mean_completion=36.56%, success_rate=18.00%, n_episodes=50
[2025-12-13 14:33:11]   interp: mean_return=5.44, mean_completion=40.29%, success_rate=24.00%, n_episodes=25
[2025-12-13 14:33:11] Per-inertia summary:
[2025-12-13 14:33:11]   inertia=0.600: mean_return=7.20, mean_completion=52.40%, success_rate=28.00%, n_episodes=25
[2025-12-13 14:33:11]   inertia=0.850: mean_return=3.32, mean_completion=35.51%, success_rate=12.00%, n_episodes=25
[2025-12-13 14:33:11]   inertia=1.000: mean_return=5.44, mean_completion=40.29%, success_rate=24.00%, n_episodes=25
[2025-12-13 14:33:11]   inertia=1.150: mean_return=5.48, mean_completion=37.61%, success_rate=24.00%, n_episodes=25
[2025-12-13 14:33:11]   inertia=1.400: mean_return=4.16, mean_completion=33.82%, success_rate=20.00%, n_episodes=25
[2025-12-13 14:33:11] ==================================================
[2025-12-13 14:33:11] ==================================================
[2025-12-13 14:33:11] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-13 14:33:11] ==================================================
[2025-12-13 14:35:08] ==================================================
[2025-12-13 14:35:08] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-13 14:35:08] ==================================================
[2025-12-13 14:35:08] Mean Return: 8.08 ± 7.86
[2025-12-13 14:35:08] Mean Completion: 60.74% ± 37.26%
[2025-12-13 14:35:08] Success Rate (full level): 29.00%
[2025-12-13 14:35:08] Mean Episode Length: 73.0
[2025-12-13 14:35:08] Per-range summary (collapsed from per-inertia):
[2025-12-13 14:35:08]   range_0:0.800-0.900: mean_return=5.06, mean_completion=45.50%, success_rate=10.42%, n_episodes=48
[2025-12-13 14:35:08]   range_1:1.100-1.200: mean_return=10.87, mean_completion=74.81%, success_rate=46.15%, n_episodes=52
[2025-12-13 14:35:08] (Per-inertia details saved in JSON: 100 values)
[2025-12-13 14:35:08] ==================================================
[2025-12-13 14:35:08] Saved final results to logs/mario_inertia_full/multi_1213_131329/seed_4/inertia_1213_1421/final_results.json
[2025-12-13 14:35:08] Model saved to logs/mario_inertia_full/multi_1213_131329/seed_4/inertia_1213_1421/final_model.zip
[2025-12-13 14:35:08] ==================================================
[2025-12-13 14:35:08] SETTING UP TRAINING
[2025-12-13 14:35:08] ==================================================
