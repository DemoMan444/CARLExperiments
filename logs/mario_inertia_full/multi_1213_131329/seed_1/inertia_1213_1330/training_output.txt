[2025-12-13 13:30:09] Initialized run directory: logs/mario_inertia_full/multi_1213_131329/seed_1/inertia_1213_1330
[2025-12-13 13:30:09] Generating training contexts (varying only mario_inertia)...
[2025-12-13 13:30:09] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-13 13:30:09] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-13 13:30:09] Using context keys in observations: NONE (vision only)
[2025-12-13 13:30:09] Training contexts (all):
[2025-12-13 13:30:09]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 2, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 13:30:09]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 2, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 13:30:09]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 13:30:09]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 13:30:09]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 13:30:09]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 13:30:09]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 13:30:09]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 13:30:09]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 13:30:09]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 13:30:09] Test contexts (all):
[2025-12-13 13:30:09]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 13:30:09]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 13:30:09]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 13:30:09]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 13:30:09]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 13:30:09]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 13:30:09]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 13:30:09]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 13:30:09]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 13:30:09]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 13:30:09]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 13:30:09]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 13:30:09]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 13:30:09]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 13:30:09]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 13:30:09]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 13:30:09]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 13:30:09]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 13:30:09]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 13:30:09]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 13:30:09]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 13:30:09]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 13:30:09]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 13:30:09]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 13:30:09]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 13:30:09] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-13 13:30:09] Creating 8 parallel environments...
[2025-12-13 13:30:24] Creating evaluation environment...
[2025-12-13 13:30:24] Train final eval contexts: 100 (n_inertias=100)
[2025-12-13 13:30:24] Creating PPO model...
[2025-12-13 13:30:25] Training Configuration:
[2025-12-13 13:30:25]   Train contexts: 10
[2025-12-13 13:30:25]   Test contexts: 25
[2025-12-13 13:30:25]   Parallel envs: 8
[2025-12-13 13:30:25]   Seed: 1
[2025-12-13 13:30:25]   Level width: 100
[2025-12-13 13:30:25]   Total timesteps: 100,000
[2025-12-13 13:30:25]   Device: cpu
[2025-12-13 13:30:25]   Use context in obs: False
[2025-12-13 13:30:25]   Test on train maps: False
[2025-12-13 13:30:25]   Run Directory: logs/mario_inertia_full/multi_1213_131329/seed_1/inertia_1213_1330
[2025-12-13 13:30:25] ==================================================
[2025-12-13 13:30:25] STARTING TRAINING
[2025-12-13 13:30:25] ==================================================
[2025-12-13 13:31:51] ----------------------------------------------------------------
[2025-12-13 13:31:51] Train @ 10,000 steps
[2025-12-13 13:31:51]   Episodes (total): 314
[2025-12-13 13:31:51]   Window(50) mean return (episode-weighted): 2.24 
[2025-12-13 13:31:51]   Window(50) mean length: 24.1
[2025-12-13 13:31:51]   Window(50) mean completion: 28.29%
[2025-12-13 13:31:51]   Uniform-per-context mean return: 1.86
[2025-12-13 13:31:51]   Uniform-per-context mean completion: 23.41%
[2025-12-13 13:31:51]   Context distribution (last 50 eps): 0:8% 1:8% 2:10% 3:10% 4:12% 5:12% 6:10% 7:10% 8:10% 9:10%
[2025-12-13 13:31:51] ----------------------------------------------------------------
[2025-12-13 13:32:47] ----------------------------------------------------------------
[2025-12-13 13:32:47] Train @ 20,000 steps
[2025-12-13 13:32:47]   Episodes (total): 762
[2025-12-13 13:32:47]   Window(50) mean return (episode-weighted): 4.14 ↑
[2025-12-13 13:32:47]   Window(50) mean length: 21.8
[2025-12-13 13:32:47]   Window(50) mean completion: 38.65%
[2025-12-13 13:32:47]   Uniform-per-context mean return: 3.27
[2025-12-13 13:32:47]   Uniform-per-context mean completion: 32.78%
[2025-12-13 13:32:47]   Context distribution (last 50 eps): 0:12% 1:12% 2:12% 3:12% 4:12% 5:10% 6:8% 7:8% 8:8% 9:6%
[2025-12-13 13:32:47] ----------------------------------------------------------------
[2025-12-13 13:33:47] ----------------------------------------------------------------
[2025-12-13 13:33:47] Train @ 30,000 steps
[2025-12-13 13:33:47]   Episodes (total): 1,192
[2025-12-13 13:33:47]   Window(50) mean return (episode-weighted): 4.96 ↑
[2025-12-13 13:33:47]   Window(50) mean length: 18.0
[2025-12-13 13:33:47]   Window(50) mean completion: 44.68%
[2025-12-13 13:33:47]   Uniform-per-context mean return: 4.18
[2025-12-13 13:33:47]   Uniform-per-context mean completion: 39.04%
[2025-12-13 13:33:47]   Context distribution (last 50 eps): 0:8% 1:10% 2:12% 3:12% 4:12% 5:10% 6:10% 7:10% 8:8% 9:8%
[2025-12-13 13:33:47] ----------------------------------------------------------------
[2025-12-13 13:34:43] ----------------------------------------------------------------
[2025-12-13 13:34:43] Train @ 40,000 steps
[2025-12-13 13:34:43]   Episodes (total): 1,662
[2025-12-13 13:34:43]   Window(50) mean return (episode-weighted): 4.78 ↓
[2025-12-13 13:34:43]   Window(50) mean length: 15.0
[2025-12-13 13:34:43]   Window(50) mean completion: 44.84%
[2025-12-13 13:34:43]   Uniform-per-context mean return: 5.11
[2025-12-13 13:34:43]   Uniform-per-context mean completion: 43.54%
[2025-12-13 13:34:43]   Context distribution (last 50 eps): 0:8% 1:10% 2:10% 3:10% 4:10% 5:8% 6:10% 7:12% 8:12% 9:10%
[2025-12-13 13:34:43] ----------------------------------------------------------------
[2025-12-13 13:35:49] ----------------------------------------------------------------
[2025-12-13 13:35:49] Train @ 50,000 steps
[2025-12-13 13:35:49]   Episodes (total): 2,030
[2025-12-13 13:35:49]   Window(50) mean return (episode-weighted): 5.24 ↑
[2025-12-13 13:35:49]   Window(50) mean length: 33.5
[2025-12-13 13:35:49]   Window(50) mean completion: 46.26%
[2025-12-13 13:35:49]   Uniform-per-context mean return: 5.01
[2025-12-13 13:35:49]   Uniform-per-context mean completion: 43.50%
[2025-12-13 13:35:49]   Context distribution (last 50 eps): 0:10% 1:12% 2:10% 3:10% 4:8% 5:12% 6:12% 7:10% 8:8% 9:8%
[2025-12-13 13:35:49] ----------------------------------------------------------------
[2025-12-13 13:36:51] ----------------------------------------------------------------
[2025-12-13 13:36:51] Train @ 60,000 steps
[2025-12-13 13:36:51]   Episodes (total): 2,467
[2025-12-13 13:36:51]   Window(50) mean return (episode-weighted): 6.10 ↑
[2025-12-13 13:36:51]   Window(50) mean length: 20.4
[2025-12-13 13:36:51]   Window(50) mean completion: 46.59%
[2025-12-13 13:36:51]   Uniform-per-context mean return: 5.45
[2025-12-13 13:36:51]   Uniform-per-context mean completion: 45.03%
[2025-12-13 13:36:51]   Context distribution (last 50 eps): 0:10% 1:12% 2:10% 3:12% 4:10% 5:6% 6:10% 7:10% 8:10% 9:10%
[2025-12-13 13:36:51] ----------------------------------------------------------------
[2025-12-13 13:36:51] Checkpoint saved at 60,000 steps to logs/mario_inertia_full/multi_1213_131329/seed_1/inertia_1213_1330/checkpoints/ppo_inertia_60000.zip
[2025-12-13 13:38:09] ----------------------------------------------------------------
[2025-12-13 13:38:09] Train @ 70,000 steps
[2025-12-13 13:38:09]   Episodes (total): 2,860
[2025-12-13 13:38:09]   Window(50) mean return (episode-weighted): 5.42 ↓
[2025-12-13 13:38:09]   Window(50) mean length: 31.7
[2025-12-13 13:38:09]   Window(50) mean completion: 43.46%
[2025-12-13 13:38:09]   Uniform-per-context mean return: 5.43
[2025-12-13 13:38:09]   Uniform-per-context mean completion: 44.49%
[2025-12-13 13:38:09]   Context distribution (last 50 eps): 0:8% 1:10% 2:6% 3:6% 4:10% 5:18% 6:12% 7:10% 8:10% 9:10%
[2025-12-13 13:38:09] ----------------------------------------------------------------
[2025-12-13 13:39:09] ----------------------------------------------------------------
[2025-12-13 13:39:09] Train @ 80,000 steps
[2025-12-13 13:39:09]   Episodes (total): 3,369
[2025-12-13 13:39:09]   Window(50) mean return (episode-weighted): 7.12 ↑
[2025-12-13 13:39:09]   Window(50) mean length: 25.9
[2025-12-13 13:39:09]   Window(50) mean completion: 52.75%
[2025-12-13 13:39:09]   Uniform-per-context mean return: 5.15
[2025-12-13 13:39:09]   Uniform-per-context mean completion: 43.22%
[2025-12-13 13:39:09]   Context distribution (last 50 eps): 0:8% 1:6% 2:12% 3:12% 4:10% 5:12% 6:12% 7:10% 8:10% 9:8%
[2025-12-13 13:39:09] ----------------------------------------------------------------
[2025-12-13 13:40:18] ----------------------------------------------------------------
[2025-12-13 13:40:18] Train @ 90,000 steps
[2025-12-13 13:40:18]   Episodes (total): 3,805
[2025-12-13 13:40:18]   Window(50) mean return (episode-weighted): 5.30 ↓
[2025-12-13 13:40:18]   Window(50) mean length: 15.0
[2025-12-13 13:40:18]   Window(50) mean completion: 41.85%
[2025-12-13 13:40:18]   Uniform-per-context mean return: 5.91
[2025-12-13 13:40:18]   Uniform-per-context mean completion: 46.39%
[2025-12-13 13:40:18]   Context distribution (last 50 eps): 0:12% 1:10% 2:10% 3:12% 4:14% 5:10% 6:6% 7:6% 8:8% 9:12%
[2025-12-13 13:40:18] ----------------------------------------------------------------
[2025-12-13 13:41:44] ----------------------------------------------------------------
[2025-12-13 13:41:44] Train @ 100,000 steps
[2025-12-13 13:41:44]   Episodes (total): 4,245
[2025-12-13 13:41:44]   Window(50) mean return (episode-weighted): 5.32 ↑
[2025-12-13 13:41:44]   Window(50) mean length: 28.3
[2025-12-13 13:41:44]   Window(50) mean completion: 44.75%
[2025-12-13 13:41:44]   Uniform-per-context mean return: 5.75
[2025-12-13 13:41:44]   Uniform-per-context mean completion: 46.15%
[2025-12-13 13:41:44]   Context distribution (last 50 eps): 0:10% 1:12% 2:12% 3:10% 4:10% 5:10% 6:12% 7:8% 8:8% 9:8%
[2025-12-13 13:41:44] ----------------------------------------------------------------
[2025-12-13 13:41:59] Saved training curve to logs/mario_inertia_full/multi_1213_131329/seed_1/inertia_1213_1330/training_curve.json
[2025-12-13 13:41:59] Saved episode history to logs/mario_inertia_full/multi_1213_131329/seed_1/inertia_1213_1330/episode_history.json
[2025-12-13 13:41:59] ==================================================
[2025-12-13 13:41:59] FINAL EVALUATION
[2025-12-13 13:41:59] ==================================================
[2025-12-13 13:45:42] ==================================================
[2025-12-13 13:45:42] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-13 13:45:42] ==================================================
[2025-12-13 13:45:42] Mean Return: 4.92 ± 6.24
[2025-12-13 13:45:42] Mean Completion: 42.78% ± 32.39%
[2025-12-13 13:45:42] Success Rate (full level): 18.40%
[2025-12-13 13:45:42] Mean Episode Length: 111.2
[2025-12-13 13:45:42] Per generalization-type summary:
[2025-12-13 13:45:42]   extra: mean_return=5.70, mean_completion=43.65%, success_rate=26.00%, n_episodes=50
[2025-12-13 13:45:42]   id: mean_return=5.04, mean_completion=47.79%, success_rate=12.00%, n_episodes=50
[2025-12-13 13:45:42]   interp: mean_return=3.12, mean_completion=30.98%, success_rate=16.00%, n_episodes=25
[2025-12-13 13:45:42] Per-inertia summary:
[2025-12-13 13:45:42]   inertia=0.600: mean_return=6.00, mean_completion=44.57%, success_rate=24.00%, n_episodes=25
[2025-12-13 13:45:42]   inertia=0.850: mean_return=4.00, mean_completion=44.75%, success_rate=0.00%, n_episodes=25
[2025-12-13 13:45:42]   inertia=1.000: mean_return=3.12, mean_completion=30.98%, success_rate=16.00%, n_episodes=25
[2025-12-13 13:45:42]   inertia=1.150: mean_return=6.08, mean_completion=50.84%, success_rate=24.00%, n_episodes=25
[2025-12-13 13:45:42]   inertia=1.400: mean_return=5.40, mean_completion=42.74%, success_rate=28.00%, n_episodes=25
[2025-12-13 13:45:42] ==================================================
[2025-12-13 13:45:42] ==================================================
[2025-12-13 13:45:42] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-13 13:45:42] ==================================================
[2025-12-13 13:46:31] ==================================================
[2025-12-13 13:46:31] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-13 13:46:31] ==================================================
[2025-12-13 13:46:31] Mean Return: 5.58 ± 7.06
[2025-12-13 13:46:31] Mean Completion: 45.63% ± 35.12%
[2025-12-13 13:46:31] Success Rate (full level): 20.00%
[2025-12-13 13:46:31] Mean Episode Length: 29.7
[2025-12-13 13:46:31] Per-range summary (collapsed from per-inertia):
[2025-12-13 13:46:31]   range_0:0.800-0.900: mean_return=2.64, mean_completion=30.47%, success_rate=4.26%, n_episodes=47
[2025-12-13 13:46:31]   range_1:1.100-1.200: mean_return=8.19, mean_completion=59.07%, success_rate=33.96%, n_episodes=53
[2025-12-13 13:46:31] (Per-inertia details saved in JSON: 100 values)
[2025-12-13 13:46:31] ==================================================
[2025-12-13 13:46:31] Saved final results to logs/mario_inertia_full/multi_1213_131329/seed_1/inertia_1213_1330/final_results.json
[2025-12-13 13:46:31] Model saved to logs/mario_inertia_full/multi_1213_131329/seed_1/inertia_1213_1330/final_model.zip
[2025-12-13 13:46:31] ==================================================
[2025-12-13 13:46:31] SETTING UP TRAINING
[2025-12-13 13:46:31] ==================================================
