[2025-12-15 13:43:51] Initialized run directory: logs/mario_inertia_full/multi_1215_134351/seed_0/inertia_1215_134351
[2025-12-15 13:43:51] Generating training contexts (varying only mario_inertia)...
[2025-12-15 13:43:51] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-15 13:43:51] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-15 13:43:51] Using context keys in observations: ['mario_inertia']
[2025-12-15 13:43:51] Training contexts (all):
[2025-12-15 13:43:51]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 1, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 13:43:51]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 1, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 13:43:51]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 2, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 13:43:51]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 2, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 13:43:51]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 13:43:51]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 13:43:51]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 13:43:51]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 13:43:51]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 13:43:51]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 13:43:51] Test contexts (all):
[2025-12-15 13:43:51]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 13:43:51]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 13:43:51]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 13:43:51]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 13:43:51]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 13:43:51]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 13:43:51]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 13:43:51]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 13:43:51]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 13:43:51]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 13:43:51]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 13:43:51]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 13:43:51]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 13:43:51]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 13:43:51]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 13:43:51]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 13:43:51]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 13:43:51]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 13:43:51]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 13:43:51]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 13:43:51]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 13:43:51]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 13:43:51]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 13:43:51]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 13:43:51]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 13:43:51] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-15 13:43:51] Creating 8 parallel environments...
[2025-12-15 13:43:58] Creating evaluation environment...
[2025-12-15 13:43:58] Train final eval contexts: 100 (n_inertias=100)
[2025-12-15 13:43:58] Creating PPO model...
[2025-12-15 13:44:00] Training Configuration:
[2025-12-15 13:44:00]   Train contexts: 10
[2025-12-15 13:44:00]   Test contexts: 25
[2025-12-15 13:44:00]   Parallel envs: 8
[2025-12-15 13:44:00]   Seed: 0
[2025-12-15 13:44:00]   Level width: 100
[2025-12-15 13:44:00]   Total timesteps: 200,000
[2025-12-15 13:44:00]   Device: cpu
[2025-12-15 13:44:00]   Use context in obs: True
[2025-12-15 13:44:00]   Context keys: ['mario_inertia']
[2025-12-15 13:44:00]   Feature fusion: hadamard
[2025-12-15 13:44:00]   Test on train maps: False
[2025-12-15 13:44:00]   Run Directory: logs/mario_inertia_full/multi_1215_134351/seed_0/inertia_1215_134351
[2025-12-15 13:44:00] ==================================================
[2025-12-15 13:44:00] STARTING TRAINING
[2025-12-15 13:44:00] ==================================================
[2025-12-15 13:46:28] ----------------------------------------------------------------
[2025-12-15 13:46:28] Train @ 20,000 steps
[2025-12-15 13:46:28]   Episodes (total): 618
[2025-12-15 13:46:28]   Window(50) mean return (episode-weighted): 2.90 
[2025-12-15 13:46:28]   Window(50) mean length: 31.2
[2025-12-15 13:46:28]   Window(50) mean completion: 35.12%
[2025-12-15 13:46:28]   Uniform-per-context mean return: 3.37
[2025-12-15 13:46:28]   Uniform-per-context mean completion: 34.55%
[2025-12-15 13:46:28]   Context distribution (last 50 eps): 0:8% 1:8% 2:12% 3:12% 4:12% 5:12% 6:10% 7:12% 8:8% 9:6%
[2025-12-15 13:46:28] ----------------------------------------------------------------
[2025-12-15 13:48:32] ----------------------------------------------------------------
[2025-12-15 13:48:32] Train @ 40,000 steps
[2025-12-15 13:48:32]   Episodes (total): 1,346
[2025-12-15 13:48:32]   Window(50) mean return (episode-weighted): 5.40 ↑
[2025-12-15 13:48:32]   Window(50) mean length: 18.2
[2025-12-15 13:48:32]   Window(50) mean completion: 43.36%
[2025-12-15 13:48:32]   Uniform-per-context mean return: 4.99
[2025-12-15 13:48:32]   Uniform-per-context mean completion: 43.74%
[2025-12-15 13:48:32]   Context distribution (last 50 eps): 0:12% 1:12% 2:12% 3:10% 4:8% 5:8% 6:8% 7:10% 8:10% 9:10%
[2025-12-15 13:48:32] ----------------------------------------------------------------
[2025-12-15 13:50:41] ----------------------------------------------------------------
[2025-12-15 13:50:41] Train @ 60,000 steps
[2025-12-15 13:50:41]   Episodes (total): 2,066
[2025-12-15 13:50:41]   Window(50) mean return (episode-weighted): 5.62 ↑
[2025-12-15 13:50:41]   Window(50) mean length: 36.3
[2025-12-15 13:50:41]   Window(50) mean completion: 46.39%
[2025-12-15 13:50:41]   Uniform-per-context mean return: 5.02
[2025-12-15 13:50:41]   Uniform-per-context mean completion: 43.75%
[2025-12-15 13:50:41]   Context distribution (last 50 eps): 0:10% 1:8% 2:8% 3:12% 4:8% 5:8% 6:8% 7:12% 8:14% 9:12%
[2025-12-15 13:50:41] ----------------------------------------------------------------
[2025-12-15 13:52:47] ----------------------------------------------------------------
[2025-12-15 13:52:47] Train @ 80,000 steps
[2025-12-15 13:52:47]   Episodes (total): 2,883
[2025-12-15 13:52:47]   Window(50) mean return (episode-weighted): 5.20 ↓
[2025-12-15 13:52:47]   Window(50) mean length: 47.5
[2025-12-15 13:52:47]   Window(50) mean completion: 43.60%
[2025-12-15 13:52:47]   Uniform-per-context mean return: 5.44
[2025-12-15 13:52:47]   Uniform-per-context mean completion: 46.31%
[2025-12-15 13:52:47]   Context distribution (last 50 eps): 0:8% 1:10% 2:10% 3:10% 4:8% 5:8% 6:8% 7:14% 8:12% 9:12%
[2025-12-15 13:52:47] ----------------------------------------------------------------
[2025-12-15 13:54:53] ----------------------------------------------------------------
[2025-12-15 13:54:53] Train @ 100,000 steps
[2025-12-15 13:54:53]   Episodes (total): 3,673
[2025-12-15 13:54:53]   Window(50) mean return (episode-weighted): 6.20 ↑
[2025-12-15 13:54:53]   Window(50) mean length: 19.3
[2025-12-15 13:54:53]   Window(50) mean completion: 48.17%
[2025-12-15 13:54:53]   Uniform-per-context mean return: 5.28
[2025-12-15 13:54:53]   Uniform-per-context mean completion: 45.72%
[2025-12-15 13:54:53]   Context distribution (last 50 eps): 0:10% 1:12% 2:12% 3:14% 4:10% 5:10% 6:8% 7:8% 8:8% 9:8%
[2025-12-15 13:54:53] ----------------------------------------------------------------
[2025-12-15 13:55:53] Checkpoint saved at 110,000 steps to logs/mario_inertia_full/multi_1215_134351/seed_0/inertia_1215_134351/checkpoints/ppo_inertia_110000.zip
[2025-12-15 13:57:00] ----------------------------------------------------------------
[2025-12-15 13:57:00] Train @ 120,000 steps
[2025-12-15 13:57:00]   Episodes (total): 4,544
[2025-12-15 13:57:00]   Window(50) mean return (episode-weighted): 4.62 ↓
[2025-12-15 13:57:00]   Window(50) mean length: 18.6
[2025-12-15 13:57:00]   Window(50) mean completion: 40.86%
[2025-12-15 13:57:00]   Uniform-per-context mean return: 5.53
[2025-12-15 13:57:00]   Uniform-per-context mean completion: 45.25%
[2025-12-15 13:57:00]   Context distribution (last 50 eps): 0:8% 1:12% 2:10% 3:12% 4:10% 5:10% 6:10% 7:10% 8:8% 9:10%
[2025-12-15 13:57:00] ----------------------------------------------------------------
[2025-12-15 13:59:32] ----------------------------------------------------------------
[2025-12-15 13:59:32] Train @ 140,000 steps
[2025-12-15 13:59:32]   Episodes (total): 5,375
[2025-12-15 13:59:32]   Window(50) mean return (episode-weighted): 4.52 ↓
[2025-12-15 13:59:32]   Window(50) mean length: 22.3
[2025-12-15 13:59:32]   Window(50) mean completion: 46.10%
[2025-12-15 13:59:32]   Uniform-per-context mean return: 5.69
[2025-12-15 13:59:32]   Uniform-per-context mean completion: 48.13%
[2025-12-15 13:59:32]   Context distribution (last 50 eps): 0:8% 1:8% 2:6% 3:8% 4:10% 5:12% 6:12% 7:12% 8:14% 9:10%
[2025-12-15 13:59:32] ----------------------------------------------------------------
[2025-12-15 14:02:21] ----------------------------------------------------------------
[2025-12-15 14:02:21] Train @ 160,000 steps
[2025-12-15 14:02:21]   Episodes (total): 6,155
[2025-12-15 14:02:21]   Window(50) mean return (episode-weighted): 5.74 ↑
[2025-12-15 14:02:21]   Window(50) mean length: 17.9
[2025-12-15 14:02:21]   Window(50) mean completion: 46.28%
[2025-12-15 14:02:21]   Uniform-per-context mean return: 6.23
[2025-12-15 14:02:21]   Uniform-per-context mean completion: 50.24%
[2025-12-15 14:02:21]   Context distribution (last 50 eps): 0:10% 1:12% 2:12% 3:12% 4:10% 5:10% 6:8% 7:6% 8:10% 9:10%
[2025-12-15 14:02:21] ----------------------------------------------------------------
[2025-12-15 14:04:52] ----------------------------------------------------------------
[2025-12-15 14:04:52] Train @ 180,000 steps
[2025-12-15 14:04:52]   Episodes (total): 7,053
[2025-12-15 14:04:52]   Window(50) mean return (episode-weighted): 6.36 ↑
[2025-12-15 14:04:52]   Window(50) mean length: 21.6
[2025-12-15 14:04:52]   Window(50) mean completion: 49.84%
[2025-12-15 14:04:52]   Uniform-per-context mean return: 6.00
[2025-12-15 14:04:52]   Uniform-per-context mean completion: 49.47%
[2025-12-15 14:04:52]   Context distribution (last 50 eps): 0:10% 1:10% 2:8% 3:8% 4:10% 5:12% 6:12% 7:10% 8:10% 9:10%
[2025-12-15 14:04:52] ----------------------------------------------------------------
[2025-12-15 14:07:34] ----------------------------------------------------------------
[2025-12-15 14:07:34] Train @ 200,000 steps
[2025-12-15 14:07:34]   Episodes (total): 7,974
[2025-12-15 14:07:34]   Window(50) mean return (episode-weighted): 7.08 ↑
[2025-12-15 14:07:34]   Window(50) mean length: 51.3
[2025-12-15 14:07:34]   Window(50) mean completion: 54.95%
[2025-12-15 14:07:34]   Uniform-per-context mean return: 5.88
[2025-12-15 14:07:34]   Uniform-per-context mean completion: 48.26%
[2025-12-15 14:07:34]   Context distribution (last 50 eps): 0:12% 1:12% 2:8% 3:8% 4:6% 5:4% 6:12% 7:14% 8:12% 9:12%
[2025-12-15 14:07:34] ----------------------------------------------------------------
[2025-12-15 14:07:48] Saved training curve to logs/mario_inertia_full/multi_1215_134351/seed_0/inertia_1215_134351/training_curve.json
[2025-12-15 14:07:48] Saved episode history to logs/mario_inertia_full/multi_1215_134351/seed_0/inertia_1215_134351/episode_history.json
[2025-12-15 14:07:48] ==================================================
[2025-12-15 14:07:48] FINAL EVALUATION
[2025-12-15 14:07:48] ==================================================
[2025-12-15 14:12:49] ==================================================
[2025-12-15 14:12:49] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-15 14:12:49] ==================================================
[2025-12-15 14:12:49] Mean Return: 5.51 ± 6.81
[2025-12-15 14:12:49] Mean Completion: 44.25% ± 33.35%
[2025-12-15 14:12:49] Success Rate (full level): 20.80%
[2025-12-15 14:12:49] Mean Episode Length: 151.9
[2025-12-15 14:12:49] Per generalization-type summary:
[2025-12-15 14:12:49]   extra: mean_return=7.68, mean_completion=51.25%, success_rate=36.00%, n_episodes=50
[2025-12-15 14:12:49]   id: mean_return=4.22, mean_completion=37.81%, success_rate=16.00%, n_episodes=50
[2025-12-15 14:12:49]   interp: mean_return=3.76, mean_completion=43.14%, success_rate=0.00%, n_episodes=25
[2025-12-15 14:12:49] Per-inertia summary:
[2025-12-15 14:12:49]   inertia=0.600: mean_return=8.16, mean_completion=49.61%, success_rate=40.00%, n_episodes=25
[2025-12-15 14:12:49]   inertia=0.850: mean_return=5.20, mean_completion=41.16%, success_rate=20.00%, n_episodes=25
[2025-12-15 14:12:49]   inertia=1.000: mean_return=3.76, mean_completion=43.14%, success_rate=0.00%, n_episodes=25
[2025-12-15 14:12:49]   inertia=1.150: mean_return=3.24, mean_completion=34.46%, success_rate=12.00%, n_episodes=25
[2025-12-15 14:12:49]   inertia=1.400: mean_return=7.20, mean_completion=52.88%, success_rate=32.00%, n_episodes=25
[2025-12-15 14:12:49] ==================================================
[2025-12-15 14:12:49] ==================================================
[2025-12-15 14:12:49] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-15 14:12:49] ==================================================
[2025-12-15 14:13:29] ==================================================
[2025-12-15 14:13:29] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-15 14:13:29] ==================================================
[2025-12-15 14:13:29] Mean Return: 6.78 ± 7.31
[2025-12-15 14:13:29] Mean Completion: 50.35% ± 34.52%
[2025-12-15 14:13:29] Success Rate (full level): 25.00%
[2025-12-15 14:13:29] Mean Episode Length: 22.7
[2025-12-15 14:13:29] Per-range summary (collapsed from per-inertia):
[2025-12-15 14:13:29]   range_0:0.800-0.900: mean_return=3.19, mean_completion=34.17%, success_rate=4.17%, n_episodes=48
[2025-12-15 14:13:29]   range_1:1.100-1.200: mean_return=10.10, mean_completion=65.28%, success_rate=44.23%, n_episodes=52
[2025-12-15 14:13:29] (Per-inertia details saved in JSON: 100 values)
[2025-12-15 14:13:29] ==================================================
[2025-12-15 14:13:29] Saved final results to logs/mario_inertia_full/multi_1215_134351/seed_0/inertia_1215_134351/final_results.json
[2025-12-15 14:13:29] Model saved to logs/mario_inertia_full/multi_1215_134351/seed_0/inertia_1215_134351/final_model.zip
[2025-12-15 14:13:30] ==================================================
[2025-12-15 14:13:30] SETTING UP TRAINING
[2025-12-15 14:13:30] ==================================================
