[2025-12-15 15:58:49] Initialized run directory: logs/mario_inertia_full/multi_1215_134351/seed_5/inertia_1215_155849
[2025-12-15 15:58:49] Generating training contexts (varying only mario_inertia)...
[2025-12-15 15:58:49] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-15 15:58:49] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-15 15:58:49] Using context keys in observations: ['mario_inertia']
[2025-12-15 15:58:49] Training contexts (all):
[2025-12-15 15:58:49]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 15:58:49]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 15:58:49]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 15:58:49]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 15:58:49]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 8, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 15:58:49]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 8, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 15:58:49]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 9, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 15:58:49]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 9, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 15:58:49]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 15:58:49]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 15:58:49] Test contexts (all):
[2025-12-15 15:58:49]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 15:58:49]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 15:58:49]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 15:58:49]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 15:58:49]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 15:58:49]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 15:58:49]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 15:58:49]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 15:58:49]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 15:58:49]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 15:58:49]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 15:58:49]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 15:58:49]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 15:58:49]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 15:58:49]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 15:58:49]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10009, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 15:58:49]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10009, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 15:58:49]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10009, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 15:58:49]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10009, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 15:58:49]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10009, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 15:58:49]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10010, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 15:58:49]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10010, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 15:58:49]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10010, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 15:58:49]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10010, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 15:58:49]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10010, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 15:58:49] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-15 15:58:49] Creating 8 parallel environments...
[2025-12-15 15:59:01] Creating evaluation environment...
[2025-12-15 15:59:01] Train final eval contexts: 100 (n_inertias=100)
[2025-12-15 15:59:01] Creating PPO model...
[2025-12-15 15:59:01] Training Configuration:
[2025-12-15 15:59:01]   Train contexts: 10
[2025-12-15 15:59:01]   Test contexts: 25
[2025-12-15 15:59:01]   Parallel envs: 8
[2025-12-15 15:59:01]   Seed: 5
[2025-12-15 15:59:01]   Level width: 100
[2025-12-15 15:59:01]   Total timesteps: 200,000
[2025-12-15 15:59:01]   Device: cpu
[2025-12-15 15:59:01]   Use context in obs: True
[2025-12-15 15:59:01]   Context keys: ['mario_inertia']
[2025-12-15 15:59:01]   Feature fusion: hadamard
[2025-12-15 15:59:01]   Test on train maps: False
[2025-12-15 15:59:01]   Run Directory: logs/mario_inertia_full/multi_1215_134351/seed_5/inertia_1215_155849
[2025-12-15 15:59:01] ==================================================
[2025-12-15 15:59:01] STARTING TRAINING
[2025-12-15 15:59:01] ==================================================
[2025-12-15 16:01:13] ----------------------------------------------------------------
[2025-12-15 16:01:13] Train @ 20,000 steps
[2025-12-15 16:01:13]   Episodes (total): 203
[2025-12-15 16:01:13]   Window(50) mean return (episode-weighted): 6.16 
[2025-12-15 16:01:13]   Window(50) mean length: 84.2
[2025-12-15 16:01:13]   Window(50) mean completion: 54.09%
[2025-12-15 16:01:13]   Uniform-per-context mean return: 4.60
[2025-12-15 16:01:13]   Uniform-per-context mean completion: 43.22%
[2025-12-15 16:01:13]   Context distribution (last 50 eps): 0:10% 1:8% 2:12% 3:10% 4:10% 5:10% 6:8% 7:12% 8:10% 9:10%
[2025-12-15 16:01:13] ----------------------------------------------------------------
[2025-12-15 16:03:04] ----------------------------------------------------------------
[2025-12-15 16:03:04] Train @ 40,000 steps
[2025-12-15 16:03:04]   Episodes (total): 388
[2025-12-15 16:03:04]   Window(50) mean return (episode-weighted): 6.24 ↑
[2025-12-15 16:03:04]   Window(50) mean length: 102.2
[2025-12-15 16:03:04]   Window(50) mean completion: 51.60%
[2025-12-15 16:03:04]   Uniform-per-context mean return: 5.28
[2025-12-15 16:03:04]   Uniform-per-context mean completion: 47.00%
[2025-12-15 16:03:04]   Context distribution (last 50 eps): 0:8% 1:8% 2:12% 3:10% 4:10% 5:10% 6:14% 7:10% 8:10% 9:8%
[2025-12-15 16:03:04] ----------------------------------------------------------------
[2025-12-15 16:05:10] ----------------------------------------------------------------
[2025-12-15 16:05:10] Train @ 60,000 steps
[2025-12-15 16:05:10]   Episodes (total): 569
[2025-12-15 16:05:10]   Window(50) mean return (episode-weighted): 8.94 ↑
[2025-12-15 16:05:10]   Window(50) mean length: 114.7
[2025-12-15 16:05:10]   Window(50) mean completion: 63.06%
[2025-12-15 16:05:10]   Uniform-per-context mean return: 6.42
[2025-12-15 16:05:10]   Uniform-per-context mean completion: 52.95%
[2025-12-15 16:05:10]   Context distribution (last 50 eps): 0:12% 1:12% 2:8% 3:4% 4:4% 5:6% 6:12% 7:14% 8:16% 9:12%
[2025-12-15 16:05:10] ----------------------------------------------------------------
[2025-12-15 16:07:30] ----------------------------------------------------------------
[2025-12-15 16:07:30] Train @ 80,000 steps
[2025-12-15 16:07:30]   Episodes (total): 789
[2025-12-15 16:07:30]   Window(50) mean return (episode-weighted): 5.86 ↓
[2025-12-15 16:07:30]   Window(50) mean length: 90.1
[2025-12-15 16:07:30]   Window(50) mean completion: 50.84%
[2025-12-15 16:07:30]   Uniform-per-context mean return: 7.03
[2025-12-15 16:07:30]   Uniform-per-context mean completion: 55.52%
[2025-12-15 16:07:30]   Context distribution (last 50 eps): 0:10% 1:8% 2:12% 3:8% 4:8% 5:10% 6:8% 7:14% 8:12% 9:10%
[2025-12-15 16:07:30] ----------------------------------------------------------------
[2025-12-15 16:09:40] ----------------------------------------------------------------
[2025-12-15 16:09:40] Train @ 100,000 steps
[2025-12-15 16:09:40]   Episodes (total): 1,011
[2025-12-15 16:09:40]   Window(50) mean return (episode-weighted): 5.66 ↓
[2025-12-15 16:09:40]   Window(50) mean length: 101.2
[2025-12-15 16:09:40]   Window(50) mean completion: 50.50%
[2025-12-15 16:09:40]   Uniform-per-context mean return: 6.67
[2025-12-15 16:09:40]   Uniform-per-context mean completion: 53.98%
[2025-12-15 16:09:40]   Context distribution (last 50 eps): 0:10% 1:10% 2:12% 3:12% 4:12% 5:12% 6:10% 7:6% 8:6% 9:10%
[2025-12-15 16:09:40] ----------------------------------------------------------------
[2025-12-15 16:10:46] Checkpoint saved at 110,000 steps to logs/mario_inertia_full/multi_1215_134351/seed_5/inertia_1215_155849/checkpoints/ppo_inertia_110000.zip
[2025-12-15 16:11:51] ----------------------------------------------------------------
[2025-12-15 16:11:51] Train @ 120,000 steps
[2025-12-15 16:11:51]   Episodes (total): 1,236
[2025-12-15 16:11:51]   Window(50) mean return (episode-weighted): 5.30 ↓
[2025-12-15 16:11:51]   Window(50) mean length: 75.4
[2025-12-15 16:11:51]   Window(50) mean completion: 47.34%
[2025-12-15 16:11:51]   Uniform-per-context mean return: 6.03
[2025-12-15 16:11:51]   Uniform-per-context mean completion: 52.47%
[2025-12-15 16:11:51]   Context distribution (last 50 eps): 0:12% 1:12% 2:8% 3:8% 4:8% 5:8% 6:10% 7:12% 8:12% 9:10%
[2025-12-15 16:11:51] ----------------------------------------------------------------
[2025-12-15 16:14:23] ----------------------------------------------------------------
[2025-12-15 16:14:23] Train @ 140,000 steps
[2025-12-15 16:14:23]   Episodes (total): 1,498
[2025-12-15 16:14:23]   Window(50) mean return (episode-weighted): 6.34 ↑
[2025-12-15 16:14:23]   Window(50) mean length: 60.6
[2025-12-15 16:14:23]   Window(50) mean completion: 54.56%
[2025-12-15 16:14:23]   Uniform-per-context mean return: 6.18
[2025-12-15 16:14:23]   Uniform-per-context mean completion: 54.52%
[2025-12-15 16:14:23]   Context distribution (last 50 eps): 0:10% 1:10% 2:8% 3:14% 4:14% 5:14% 6:10% 7:4% 8:6% 9:10%
[2025-12-15 16:14:23] ----------------------------------------------------------------
[2025-12-15 16:16:55] ----------------------------------------------------------------
[2025-12-15 16:16:55] Train @ 160,000 steps
[2025-12-15 16:16:55]   Episodes (total): 1,764
[2025-12-15 16:16:55]   Window(50) mean return (episode-weighted): 7.02 ↑
[2025-12-15 16:16:55]   Window(50) mean length: 88.6
[2025-12-15 16:16:55]   Window(50) mean completion: 57.41%
[2025-12-15 16:16:55]   Uniform-per-context mean return: 6.70
[2025-12-15 16:16:55]   Uniform-per-context mean completion: 57.16%
[2025-12-15 16:16:55]   Context distribution (last 50 eps): 0:12% 1:12% 2:6% 3:6% 4:6% 5:6% 6:8% 7:14% 8:16% 9:14%
[2025-12-15 16:16:55] ----------------------------------------------------------------
[2025-12-15 16:19:20] ----------------------------------------------------------------
[2025-12-15 16:19:20] Train @ 180,000 steps
[2025-12-15 16:19:20]   Episodes (total): 2,007
[2025-12-15 16:19:20]   Window(50) mean return (episode-weighted): 8.16 ↑
[2025-12-15 16:19:20]   Window(50) mean length: 72.2
[2025-12-15 16:19:20]   Window(50) mean completion: 61.11%
[2025-12-15 16:19:20]   Uniform-per-context mean return: 7.35
[2025-12-15 16:19:20]   Uniform-per-context mean completion: 59.44%
[2025-12-15 16:19:20]   Context distribution (last 50 eps): 0:8% 1:8% 2:10% 3:10% 4:10% 5:12% 6:16% 7:12% 8:6% 9:8%
[2025-12-15 16:19:20] ----------------------------------------------------------------
[2025-12-15 16:21:56] ----------------------------------------------------------------
[2025-12-15 16:21:56] Train @ 200,000 steps
[2025-12-15 16:21:56]   Episodes (total): 2,284
[2025-12-15 16:21:56]   Window(50) mean return (episode-weighted): 5.44 ↓
[2025-12-15 16:21:56]   Window(50) mean length: 57.4
[2025-12-15 16:21:56]   Window(50) mean completion: 51.68%
[2025-12-15 16:21:56]   Uniform-per-context mean return: 7.42
[2025-12-15 16:21:56]   Uniform-per-context mean completion: 59.24%
[2025-12-15 16:21:56]   Context distribution (last 50 eps): 0:12% 1:12% 2:10% 3:8% 4:10% 5:12% 6:10% 7:8% 8:8% 9:10%
[2025-12-15 16:21:56] ----------------------------------------------------------------
[2025-12-15 16:22:23] Saved training curve to logs/mario_inertia_full/multi_1215_134351/seed_5/inertia_1215_155849/training_curve.json
[2025-12-15 16:22:23] Saved episode history to logs/mario_inertia_full/multi_1215_134351/seed_5/inertia_1215_155849/episode_history.json
[2025-12-15 16:22:23] ==================================================
[2025-12-15 16:22:23] FINAL EVALUATION
[2025-12-15 16:22:23] ==================================================
[2025-12-15 16:22:54] ==================================================
[2025-12-15 16:22:54] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-15 16:22:54] ==================================================
[2025-12-15 16:22:54] Mean Return: 4.71 ± 6.56
[2025-12-15 16:22:54] Mean Completion: 40.83% ± 34.17%
[2025-12-15 16:22:54] Success Rate (full level): 18.40%
[2025-12-15 16:22:54] Mean Episode Length: 14.2
[2025-12-15 16:22:54] Per generalization-type summary:
[2025-12-15 16:22:54]   extra: mean_return=5.14, mean_completion=45.45%, success_rate=22.00%, n_episodes=50
[2025-12-15 16:22:54]   id: mean_return=3.04, mean_completion=32.87%, success_rate=8.00%, n_episodes=50
[2025-12-15 16:22:54]   interp: mean_return=7.20, mean_completion=47.50%, success_rate=32.00%, n_episodes=25
[2025-12-15 16:22:54] Per-inertia summary:
[2025-12-15 16:22:54]   inertia=0.600: mean_return=2.64, mean_completion=26.74%, success_rate=16.00%, n_episodes=25
[2025-12-15 16:22:54]   inertia=0.850: mean_return=3.64, mean_completion=33.91%, success_rate=8.00%, n_episodes=25
[2025-12-15 16:22:54]   inertia=1.000: mean_return=7.20, mean_completion=47.50%, success_rate=32.00%, n_episodes=25
[2025-12-15 16:22:54]   inertia=1.150: mean_return=2.44, mean_completion=31.84%, success_rate=8.00%, n_episodes=25
[2025-12-15 16:22:54]   inertia=1.400: mean_return=7.64, mean_completion=64.16%, success_rate=28.00%, n_episodes=25
[2025-12-15 16:22:54] ==================================================
[2025-12-15 16:22:54] ==================================================
[2025-12-15 16:22:54] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-15 16:22:54] ==================================================
[2025-12-15 16:24:36] ==================================================
[2025-12-15 16:24:36] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-15 16:24:36] ==================================================
[2025-12-15 16:24:36] Mean Return: 7.18 ± 7.09
[2025-12-15 16:24:36] Mean Completion: 58.54% ± 34.40%
[2025-12-15 16:24:36] Success Rate (full level): 22.00%
[2025-12-15 16:24:36] Mean Episode Length: 61.3
[2025-12-15 16:24:36] Per-range summary (collapsed from per-inertia):
[2025-12-15 16:24:36]   range_0:0.800-0.900: mean_return=4.85, mean_completion=45.87%, success_rate=8.70%, n_episodes=46
[2025-12-15 16:24:36]   range_1:1.100-1.200: mean_return=9.17, mean_completion=69.33%, success_rate=33.33%, n_episodes=54
[2025-12-15 16:24:36] (Per-inertia details saved in JSON: 100 values)
[2025-12-15 16:24:36] ==================================================
[2025-12-15 16:24:36] Saved final results to logs/mario_inertia_full/multi_1215_134351/seed_5/inertia_1215_155849/final_results.json
[2025-12-15 16:24:36] Model saved to logs/mario_inertia_full/multi_1215_134351/seed_5/inertia_1215_155849/final_model.zip
[2025-12-15 16:24:37] ==================================================
[2025-12-15 16:24:37] SETTING UP TRAINING
[2025-12-15 16:24:37] ==================================================
