[2025-12-15 14:40:17] Initialized run directory: logs/mario_inertia_full/multi_1215_134351/seed_2/inertia_1215_144017
[2025-12-15 14:40:17] Generating training contexts (varying only mario_inertia)...
[2025-12-15 14:40:17] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-15 14:40:17] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-15 14:40:17] Using context keys in observations: ['mario_inertia']
[2025-12-15 14:40:17] Training contexts (all):
[2025-12-15 14:40:17]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 14:40:17]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 14:40:17]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 14:40:17]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 14:40:17]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 14:40:17]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 14:40:17]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 14:40:17]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 14:40:17]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 14:40:17]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 14:40:17] Test contexts (all):
[2025-12-15 14:40:17]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 14:40:17]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 14:40:17]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 14:40:17]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 14:40:17]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 14:40:17]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 14:40:17]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 14:40:17]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 14:40:17]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 14:40:17]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 14:40:17]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 14:40:17]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 14:40:17]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 14:40:17]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 14:40:17]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 14:40:17]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 14:40:17]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 14:40:17]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 14:40:17]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 14:40:17]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 14:40:17]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 14:40:17]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 14:40:17]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 14:40:17]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 14:40:17]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 14:40:17] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-15 14:40:17] Creating 8 parallel environments...
[2025-12-15 14:40:31] Creating evaluation environment...
[2025-12-15 14:40:31] Train final eval contexts: 100 (n_inertias=100)
[2025-12-15 14:40:31] Creating PPO model...
[2025-12-15 14:40:31] Training Configuration:
[2025-12-15 14:40:31]   Train contexts: 10
[2025-12-15 14:40:31]   Test contexts: 25
[2025-12-15 14:40:31]   Parallel envs: 8
[2025-12-15 14:40:31]   Seed: 2
[2025-12-15 14:40:31]   Level width: 100
[2025-12-15 14:40:31]   Total timesteps: 200,000
[2025-12-15 14:40:31]   Device: cpu
[2025-12-15 14:40:31]   Use context in obs: True
[2025-12-15 14:40:31]   Context keys: ['mario_inertia']
[2025-12-15 14:40:31]   Feature fusion: hadamard
[2025-12-15 14:40:31]   Test on train maps: False
[2025-12-15 14:40:31]   Run Directory: logs/mario_inertia_full/multi_1215_134351/seed_2/inertia_1215_144017
[2025-12-15 14:40:31] ==================================================
[2025-12-15 14:40:31] STARTING TRAINING
[2025-12-15 14:40:31] ==================================================
[2025-12-15 14:42:49] ----------------------------------------------------------------
[2025-12-15 14:42:49] Train @ 20,000 steps
[2025-12-15 14:42:49]   Episodes (total): 319
[2025-12-15 14:42:49]   Window(50) mean return (episode-weighted): 7.08 
[2025-12-15 14:42:49]   Window(50) mean length: 75.8
[2025-12-15 14:42:49]   Window(50) mean completion: 52.58%
[2025-12-15 14:42:49]   Uniform-per-context mean return: 4.55
[2025-12-15 14:42:49]   Uniform-per-context mean completion: 40.00%
[2025-12-15 14:42:49]   Context distribution (last 50 eps): 0:12% 1:8% 2:8% 3:10% 4:10% 5:10% 6:10% 7:12% 8:10% 9:10%
[2025-12-15 14:42:49] ----------------------------------------------------------------
[2025-12-15 14:44:33] ----------------------------------------------------------------
[2025-12-15 14:44:33] Train @ 40,000 steps
[2025-12-15 14:44:33]   Episodes (total): 565
[2025-12-15 14:44:33]   Window(50) mean return (episode-weighted): 5.90 ↓
[2025-12-15 14:44:33]   Window(50) mean length: 84.2
[2025-12-15 14:44:33]   Window(50) mean completion: 49.52%
[2025-12-15 14:44:33]   Uniform-per-context mean return: 5.32
[2025-12-15 14:44:33]   Uniform-per-context mean completion: 46.31%
[2025-12-15 14:44:33]   Context distribution (last 50 eps): 0:8% 1:8% 2:10% 3:10% 4:10% 5:10% 6:10% 7:12% 8:16% 9:6%
[2025-12-15 14:44:33] ----------------------------------------------------------------
[2025-12-15 14:46:19] ----------------------------------------------------------------
[2025-12-15 14:46:19] Train @ 60,000 steps
[2025-12-15 14:46:19]   Episodes (total): 941
[2025-12-15 14:46:19]   Window(50) mean return (episode-weighted): 7.86 ↑
[2025-12-15 14:46:19]   Window(50) mean length: 37.9
[2025-12-15 14:46:19]   Window(50) mean completion: 58.36%
[2025-12-15 14:46:19]   Uniform-per-context mean return: 6.79
[2025-12-15 14:46:19]   Uniform-per-context mean completion: 54.30%
[2025-12-15 14:46:19]   Context distribution (last 50 eps): 0:6% 1:6% 2:8% 3:10% 4:14% 5:14% 6:14% 7:16% 8:8% 9:4%
[2025-12-15 14:46:19] ----------------------------------------------------------------
[2025-12-15 14:48:05] ----------------------------------------------------------------
[2025-12-15 14:48:05] Train @ 80,000 steps
[2025-12-15 14:48:05]   Episodes (total): 1,365
[2025-12-15 14:48:05]   Window(50) mean return (episode-weighted): 5.78 ↓
[2025-12-15 14:48:05]   Window(50) mean length: 38.5
[2025-12-15 14:48:05]   Window(50) mean completion: 46.84%
[2025-12-15 14:48:05]   Uniform-per-context mean return: 6.52
[2025-12-15 14:48:05]   Uniform-per-context mean completion: 53.21%
[2025-12-15 14:48:05]   Context distribution (last 50 eps): 0:10% 1:12% 2:10% 3:12% 4:10% 5:10% 6:8% 7:8% 8:10% 9:10%
[2025-12-15 14:48:05] ----------------------------------------------------------------
[2025-12-15 14:50:07] ----------------------------------------------------------------
[2025-12-15 14:50:07] Train @ 100,000 steps
[2025-12-15 14:50:07]   Episodes (total): 1,814
[2025-12-15 14:50:07]   Window(50) mean return (episode-weighted): 6.98 ↑
[2025-12-15 14:50:07]   Window(50) mean length: 24.1
[2025-12-15 14:50:07]   Window(50) mean completion: 52.73%
[2025-12-15 14:50:07]   Uniform-per-context mean return: 6.32
[2025-12-15 14:50:07]   Uniform-per-context mean completion: 51.96%
[2025-12-15 14:50:07]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:12% 4:10% 5:10% 6:10% 7:10% 8:8% 9:10%
[2025-12-15 14:50:07] ----------------------------------------------------------------
[2025-12-15 14:51:09] Checkpoint saved at 110,000 steps to logs/mario_inertia_full/multi_1215_134351/seed_2/inertia_1215_144017/checkpoints/ppo_inertia_110000.zip
[2025-12-15 14:52:19] ----------------------------------------------------------------
[2025-12-15 14:52:19] Train @ 120,000 steps
[2025-12-15 14:52:19]   Episodes (total): 2,253
[2025-12-15 14:52:19]   Window(50) mean return (episode-weighted): 6.94 ↓
[2025-12-15 14:52:19]   Window(50) mean length: 31.6
[2025-12-15 14:52:19]   Window(50) mean completion: 52.85%
[2025-12-15 14:52:19]   Uniform-per-context mean return: 7.09
[2025-12-15 14:52:19]   Uniform-per-context mean completion: 56.01%
[2025-12-15 14:52:19]   Context distribution (last 50 eps): 0:8% 1:8% 2:10% 3:10% 4:12% 5:12% 6:12% 7:12% 8:8% 9:8%
[2025-12-15 14:52:19] ----------------------------------------------------------------
[2025-12-15 14:54:56] ----------------------------------------------------------------
[2025-12-15 14:54:56] Train @ 140,000 steps
[2025-12-15 14:54:56]   Episodes (total): 2,713
[2025-12-15 14:54:56]   Window(50) mean return (episode-weighted): 8.48 ↑
[2025-12-15 14:54:56]   Window(50) mean length: 33.3
[2025-12-15 14:54:56]   Window(50) mean completion: 60.73%
[2025-12-15 14:54:56]   Uniform-per-context mean return: 7.89
[2025-12-15 14:54:56]   Uniform-per-context mean completion: 58.36%
[2025-12-15 14:54:56]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:10% 4:8% 5:10% 6:10% 7:10% 8:10% 9:12%
[2025-12-15 14:54:56] ----------------------------------------------------------------
[2025-12-15 14:57:26] ----------------------------------------------------------------
[2025-12-15 14:57:26] Train @ 160,000 steps
[2025-12-15 14:57:26]   Episodes (total): 3,230
[2025-12-15 14:57:26]   Window(50) mean return (episode-weighted): 8.40 ↓
[2025-12-15 14:57:26]   Window(50) mean length: 31.5
[2025-12-15 14:57:26]   Window(50) mean completion: 61.37%
[2025-12-15 14:57:26]   Uniform-per-context mean return: 7.15
[2025-12-15 14:57:26]   Uniform-per-context mean completion: 55.54%
[2025-12-15 14:57:26]   Context distribution (last 50 eps): 0:10% 1:8% 2:6% 3:10% 4:10% 5:10% 6:10% 7:12% 8:12% 9:12%
[2025-12-15 14:57:26] ----------------------------------------------------------------
[2025-12-15 14:59:47] ----------------------------------------------------------------
[2025-12-15 14:59:47] Train @ 180,000 steps
[2025-12-15 14:59:47]   Episodes (total): 3,852
[2025-12-15 14:59:47]   Window(50) mean return (episode-weighted): 7.00 ↓
[2025-12-15 14:59:47]   Window(50) mean length: 31.6
[2025-12-15 14:59:47]   Window(50) mean completion: 55.44%
[2025-12-15 14:59:47]   Uniform-per-context mean return: 7.67
[2025-12-15 14:59:47]   Uniform-per-context mean completion: 58.32%
[2025-12-15 14:59:47]   Context distribution (last 50 eps): 0:12% 1:12% 2:14% 3:10% 4:10% 5:8% 6:8% 7:8% 8:8% 9:10%
[2025-12-15 14:59:47] ----------------------------------------------------------------
[2025-12-15 15:02:21] ----------------------------------------------------------------
[2025-12-15 15:02:21] Train @ 200,000 steps
[2025-12-15 15:02:21]   Episodes (total): 4,460
[2025-12-15 15:02:21]   Window(50) mean return (episode-weighted): 7.46 ↑
[2025-12-15 15:02:21]   Window(50) mean length: 29.9
[2025-12-15 15:02:21]   Window(50) mean completion: 57.09%
[2025-12-15 15:02:21]   Uniform-per-context mean return: 7.35
[2025-12-15 15:02:21]   Uniform-per-context mean completion: 57.63%
[2025-12-15 15:02:21]   Context distribution (last 50 eps): 0:8% 1:8% 2:8% 3:10% 4:10% 5:12% 6:12% 7:12% 8:12% 9:8%
[2025-12-15 15:02:21] ----------------------------------------------------------------
[2025-12-15 15:02:35] Saved training curve to logs/mario_inertia_full/multi_1215_134351/seed_2/inertia_1215_144017/training_curve.json
[2025-12-15 15:02:35] Saved episode history to logs/mario_inertia_full/multi_1215_134351/seed_2/inertia_1215_144017/episode_history.json
[2025-12-15 15:02:35] ==================================================
[2025-12-15 15:02:35] FINAL EVALUATION
[2025-12-15 15:02:35] ==================================================
[2025-12-15 15:05:38] ==================================================
[2025-12-15 15:05:38] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-15 15:05:38] ==================================================
[2025-12-15 15:05:38] Mean Return: 5.06 ± 6.37
[2025-12-15 15:05:38] Mean Completion: 42.64% ± 31.60%
[2025-12-15 15:05:38] Success Rate (full level): 19.20%
[2025-12-15 15:05:38] Mean Episode Length: 90.2
[2025-12-15 15:05:38] Per generalization-type summary:
[2025-12-15 15:05:38]   extra: mean_return=4.18, mean_completion=40.95%, success_rate=8.00%, n_episodes=50
[2025-12-15 15:05:38]   id: mean_return=4.54, mean_completion=38.89%, success_rate=22.00%, n_episodes=50
[2025-12-15 15:05:38]   interp: mean_return=7.88, mean_completion=53.53%, success_rate=36.00%, n_episodes=25
[2025-12-15 15:05:38] Per-inertia summary:
[2025-12-15 15:05:38]   inertia=0.600: mean_return=3.84, mean_completion=43.73%, success_rate=0.00%, n_episodes=25
[2025-12-15 15:05:38]   inertia=0.850: mean_return=4.76, mean_completion=39.81%, success_rate=24.00%, n_episodes=25
[2025-12-15 15:05:38]   inertia=1.000: mean_return=7.88, mean_completion=53.53%, success_rate=36.00%, n_episodes=25
[2025-12-15 15:05:38]   inertia=1.150: mean_return=4.32, mean_completion=37.97%, success_rate=20.00%, n_episodes=25
[2025-12-15 15:05:38]   inertia=1.400: mean_return=4.52, mean_completion=38.18%, success_rate=16.00%, n_episodes=25
[2025-12-15 15:05:38] ==================================================
[2025-12-15 15:05:38] ==================================================
[2025-12-15 15:05:38] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-15 15:05:38] ==================================================
[2025-12-15 15:06:43] ==================================================
[2025-12-15 15:06:43] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-15 15:06:43] ==================================================
[2025-12-15 15:06:43] Mean Return: 7.65 ± 7.51
[2025-12-15 15:06:43] Mean Completion: 58.56% ± 34.82%
[2025-12-15 15:06:43] Success Rate (full level): 26.00%
[2025-12-15 15:06:43] Mean Episode Length: 38.2
[2025-12-15 15:06:43] Per-range summary (collapsed from per-inertia):
[2025-12-15 15:06:43]   range_0:0.800-0.900: mean_return=5.49, mean_completion=47.10%, success_rate=14.29%, n_episodes=49
[2025-12-15 15:06:43]   range_1:1.100-1.200: mean_return=9.73, mean_completion=69.58%, success_rate=37.25%, n_episodes=51
[2025-12-15 15:06:43] (Per-inertia details saved in JSON: 100 values)
[2025-12-15 15:06:43] ==================================================
[2025-12-15 15:06:43] Saved final results to logs/mario_inertia_full/multi_1215_134351/seed_2/inertia_1215_144017/final_results.json
[2025-12-15 15:06:43] Model saved to logs/mario_inertia_full/multi_1215_134351/seed_2/inertia_1215_144017/final_model.zip
[2025-12-15 15:06:43] ==================================================
[2025-12-15 15:06:43] SETTING UP TRAINING
[2025-12-15 15:06:43] ==================================================
