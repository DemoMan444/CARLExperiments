[2025-12-15 15:06:43] Initialized run directory: logs/mario_inertia_full/multi_1215_134351/seed_3/inertia_1215_150643
[2025-12-15 15:06:43] Generating training contexts (varying only mario_inertia)...
[2025-12-15 15:06:43] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-15 15:06:43] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-15 15:06:43] Using context keys in observations: ['mario_inertia']
[2025-12-15 15:06:43] Training contexts (all):
[2025-12-15 15:06:43]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 15:06:43]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 15:06:43]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 15:06:43]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 15:06:43]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 15:06:43]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 6, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 15:06:43]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 15:06:43]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 7, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 15:06:43]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 8, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-15 15:06:43]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 8, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-15 15:06:43] Test contexts (all):
[2025-12-15 15:06:43]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 15:06:43]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 15:06:43]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 15:06:43]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 15:06:43]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 15:06:43]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 15:06:43]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 15:06:43]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 15:06:43]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 15:06:43]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 15:06:43]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 15:06:43]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 15:06:43]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 15:06:43]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 15:06:43]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10006, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 15:06:43]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 15:06:43]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 15:06:43]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 15:06:43]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 15:06:43]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10007, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 15:06:43]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-15 15:06:43]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-15 15:06:43]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-15 15:06:43]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-15 15:06:43]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10008, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-15 15:06:43] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-15 15:06:43] Creating 8 parallel environments...
[2025-12-15 15:06:57] Creating evaluation environment...
[2025-12-15 15:06:58] Train final eval contexts: 100 (n_inertias=100)
[2025-12-15 15:06:58] Creating PPO model...
[2025-12-15 15:06:58] Training Configuration:
[2025-12-15 15:06:58]   Train contexts: 10
[2025-12-15 15:06:58]   Test contexts: 25
[2025-12-15 15:06:58]   Parallel envs: 8
[2025-12-15 15:06:58]   Seed: 3
[2025-12-15 15:06:58]   Level width: 100
[2025-12-15 15:06:58]   Total timesteps: 200,000
[2025-12-15 15:06:58]   Device: cpu
[2025-12-15 15:06:58]   Use context in obs: True
[2025-12-15 15:06:58]   Context keys: ['mario_inertia']
[2025-12-15 15:06:58]   Feature fusion: hadamard
[2025-12-15 15:06:58]   Test on train maps: False
[2025-12-15 15:06:58]   Run Directory: logs/mario_inertia_full/multi_1215_134351/seed_3/inertia_1215_150643
[2025-12-15 15:06:58] ==================================================
[2025-12-15 15:06:58] STARTING TRAINING
[2025-12-15 15:06:58] ==================================================
[2025-12-15 15:09:30] ----------------------------------------------------------------
[2025-12-15 15:09:30] Train @ 20,000 steps
[2025-12-15 15:09:30]   Episodes (total): 339
[2025-12-15 15:09:30]   Window(50) mean return (episode-weighted): 4.68 
[2025-12-15 15:09:30]   Window(50) mean length: 63.9
[2025-12-15 15:09:30]   Window(50) mean completion: 39.19%
[2025-12-15 15:09:30]   Uniform-per-context mean return: 3.42
[2025-12-15 15:09:30]   Uniform-per-context mean completion: 31.24%
[2025-12-15 15:09:30]   Context distribution (last 50 eps): 0:10% 1:10% 2:12% 3:12% 4:12% 5:12% 6:8% 7:8% 8:8% 9:8%
[2025-12-15 15:09:30] ----------------------------------------------------------------
[2025-12-15 15:11:19] ----------------------------------------------------------------
[2025-12-15 15:11:19] Train @ 40,000 steps
[2025-12-15 15:11:19]   Episodes (total): 549
[2025-12-15 15:11:19]   Window(50) mean return (episode-weighted): 5.34 ↑
[2025-12-15 15:11:19]   Window(50) mean length: 69.2
[2025-12-15 15:11:19]   Window(50) mean completion: 44.40%
[2025-12-15 15:11:19]   Uniform-per-context mean return: 4.26
[2025-12-15 15:11:19]   Uniform-per-context mean completion: 37.51%
[2025-12-15 15:11:19]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:12% 4:12% 5:12% 6:14% 7:4% 8:8% 9:8%
[2025-12-15 15:11:19] ----------------------------------------------------------------
[2025-12-15 15:13:12] ----------------------------------------------------------------
[2025-12-15 15:13:12] Train @ 60,000 steps
[2025-12-15 15:13:12]   Episodes (total): 860
[2025-12-15 15:13:12]   Window(50) mean return (episode-weighted): 6.02 ↑
[2025-12-15 15:13:12]   Window(50) mean length: 56.4
[2025-12-15 15:13:12]   Window(50) mean completion: 45.27%
[2025-12-15 15:13:12]   Uniform-per-context mean return: 4.95
[2025-12-15 15:13:12]   Uniform-per-context mean completion: 41.45%
[2025-12-15 15:13:12]   Context distribution (last 50 eps): 0:8% 1:8% 2:10% 3:10% 4:10% 5:10% 6:14% 7:10% 8:10% 9:10%
[2025-12-15 15:13:12] ----------------------------------------------------------------
[2025-12-15 15:15:20] ----------------------------------------------------------------
[2025-12-15 15:15:20] Train @ 80,000 steps
[2025-12-15 15:15:20]   Episodes (total): 1,235
[2025-12-15 15:15:20]   Window(50) mean return (episode-weighted): 4.28 ↓
[2025-12-15 15:15:20]   Window(50) mean length: 39.8
[2025-12-15 15:15:20]   Window(50) mean completion: 43.57%
[2025-12-15 15:15:20]   Uniform-per-context mean return: 4.96
[2025-12-15 15:15:20]   Uniform-per-context mean completion: 42.64%
[2025-12-15 15:15:20]   Context distribution (last 50 eps): 0:8% 1:10% 2:10% 3:12% 4:12% 5:12% 6:4% 7:10% 8:10% 9:12%
[2025-12-15 15:15:20] ----------------------------------------------------------------
[2025-12-15 15:17:31] ----------------------------------------------------------------
[2025-12-15 15:17:31] Train @ 100,000 steps
[2025-12-15 15:17:31]   Episodes (total): 1,627
[2025-12-15 15:17:31]   Window(50) mean return (episode-weighted): 6.22 ↑
[2025-12-15 15:17:31]   Window(50) mean length: 86.1
[2025-12-15 15:17:31]   Window(50) mean completion: 50.83%
[2025-12-15 15:17:31]   Uniform-per-context mean return: 5.25
[2025-12-15 15:17:31]   Uniform-per-context mean completion: 45.44%
[2025-12-15 15:17:31]   Context distribution (last 50 eps): 0:10% 1:8% 2:8% 3:8% 4:8% 5:8% 6:12% 7:16% 8:12% 9:10%
[2025-12-15 15:17:31] ----------------------------------------------------------------
[2025-12-15 15:18:46] Checkpoint saved at 110,000 steps to logs/mario_inertia_full/multi_1215_134351/seed_3/inertia_1215_150643/checkpoints/ppo_inertia_110000.zip
[2025-12-15 15:20:04] ----------------------------------------------------------------
[2025-12-15 15:20:04] Train @ 120,000 steps
[2025-12-15 15:20:04]   Episodes (total): 2,047
[2025-12-15 15:20:04]   Window(50) mean return (episode-weighted): 8.12 ↑
[2025-12-15 15:20:04]   Window(50) mean length: 46.1
[2025-12-15 15:20:04]   Window(50) mean completion: 57.73%
[2025-12-15 15:20:04]   Uniform-per-context mean return: 6.61
[2025-12-15 15:20:04]   Uniform-per-context mean completion: 51.21%
[2025-12-15 15:20:04]   Context distribution (last 50 eps): 0:8% 1:12% 2:12% 3:14% 4:12% 5:12% 6:10% 7:6% 8:6% 9:8%
[2025-12-15 15:20:04] ----------------------------------------------------------------
[2025-12-15 15:22:47] ----------------------------------------------------------------
[2025-12-15 15:22:47] Train @ 140,000 steps
[2025-12-15 15:22:47]   Episodes (total): 2,484
[2025-12-15 15:22:47]   Window(50) mean return (episode-weighted): 7.16 ↓
[2025-12-15 15:22:47]   Window(50) mean length: 41.2
[2025-12-15 15:22:47]   Window(50) mean completion: 53.93%
[2025-12-15 15:22:47]   Uniform-per-context mean return: 7.19
[2025-12-15 15:22:47]   Uniform-per-context mean completion: 54.87%
[2025-12-15 15:22:47]   Context distribution (last 50 eps): 0:8% 1:8% 2:10% 3:14% 4:14% 5:14% 6:8% 7:8% 8:8% 9:8%
[2025-12-15 15:22:47] ----------------------------------------------------------------
[2025-12-15 15:25:28] ----------------------------------------------------------------
[2025-12-15 15:25:28] Train @ 160,000 steps
[2025-12-15 15:25:28]   Episodes (total): 3,057
[2025-12-15 15:25:28]   Window(50) mean return (episode-weighted): 5.78 ↓
[2025-12-15 15:25:28]   Window(50) mean length: 31.4
[2025-12-15 15:25:28]   Window(50) mean completion: 50.58%
[2025-12-15 15:25:28]   Uniform-per-context mean return: 7.26
[2025-12-15 15:25:28]   Uniform-per-context mean completion: 56.06%
[2025-12-15 15:25:28]   Context distribution (last 50 eps): 0:10% 1:8% 2:8% 3:8% 4:8% 5:10% 6:10% 7:12% 8:14% 9:12%
[2025-12-15 15:25:28] ----------------------------------------------------------------
[2025-12-15 15:27:52] ----------------------------------------------------------------
[2025-12-15 15:27:52] Train @ 180,000 steps
[2025-12-15 15:27:52]   Episodes (total): 3,687
[2025-12-15 15:27:52]   Window(50) mean return (episode-weighted): 7.10 ↑
[2025-12-15 15:27:52]   Window(50) mean length: 30.9
[2025-12-15 15:27:52]   Window(50) mean completion: 52.35%
[2025-12-15 15:27:52]   Uniform-per-context mean return: 7.18
[2025-12-15 15:27:52]   Uniform-per-context mean completion: 56.27%
[2025-12-15 15:27:52]   Context distribution (last 50 eps): 0:8% 1:12% 2:12% 3:12% 4:12% 5:8% 6:12% 7:8% 8:8% 9:8%
[2025-12-15 15:27:52] ----------------------------------------------------------------
[2025-12-15 15:30:27] ----------------------------------------------------------------
[2025-12-15 15:30:27] Train @ 200,000 steps
[2025-12-15 15:30:27]   Episodes (total): 4,343
[2025-12-15 15:30:27]   Window(50) mean return (episode-weighted): 5.60 ↓
[2025-12-15 15:30:27]   Window(50) mean length: 21.6
[2025-12-15 15:30:27]   Window(50) mean completion: 47.42%
[2025-12-15 15:30:27]   Uniform-per-context mean return: 7.26
[2025-12-15 15:30:27]   Uniform-per-context mean completion: 54.98%
[2025-12-15 15:30:27]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:12% 4:12% 5:12% 6:6% 7:6% 8:12% 9:10%
[2025-12-15 15:30:27] ----------------------------------------------------------------
[2025-12-15 15:30:42] Saved training curve to logs/mario_inertia_full/multi_1215_134351/seed_3/inertia_1215_150643/training_curve.json
[2025-12-15 15:30:42] Saved episode history to logs/mario_inertia_full/multi_1215_134351/seed_3/inertia_1215_150643/episode_history.json
[2025-12-15 15:30:42] ==================================================
[2025-12-15 15:30:42] FINAL EVALUATION
[2025-12-15 15:30:42] ==================================================
[2025-12-15 15:31:11] ==================================================
[2025-12-15 15:31:11] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-15 15:31:11] ==================================================
[2025-12-15 15:31:11] Mean Return: 5.76 ± 7.17
[2025-12-15 15:31:11] Mean Completion: 44.77% ± 36.24%
[2025-12-15 15:31:11] Success Rate (full level): 24.80%
[2025-12-15 15:31:11] Mean Episode Length: 13.6
[2025-12-15 15:31:11] Per generalization-type summary:
[2025-12-15 15:31:11]   extra: mean_return=4.02, mean_completion=36.13%, success_rate=16.00%, n_episodes=50
[2025-12-15 15:31:11]   id: mean_return=8.30, mean_completion=56.07%, success_rate=38.00%, n_episodes=50
[2025-12-15 15:31:11]   interp: mean_return=4.16, mean_completion=39.44%, success_rate=16.00%, n_episodes=25
[2025-12-15 15:31:11] Per-inertia summary:
[2025-12-15 15:31:11]   inertia=0.600: mean_return=3.48, mean_completion=35.11%, success_rate=16.00%, n_episodes=25
[2025-12-15 15:31:11]   inertia=0.850: mean_return=7.72, mean_completion=53.76%, success_rate=36.00%, n_episodes=25
[2025-12-15 15:31:11]   inertia=1.000: mean_return=4.16, mean_completion=39.44%, success_rate=16.00%, n_episodes=25
[2025-12-15 15:31:11]   inertia=1.150: mean_return=8.88, mean_completion=58.38%, success_rate=40.00%, n_episodes=25
[2025-12-15 15:31:11]   inertia=1.400: mean_return=4.56, mean_completion=37.16%, success_rate=16.00%, n_episodes=25
[2025-12-15 15:31:11] ==================================================
[2025-12-15 15:31:11] ==================================================
[2025-12-15 15:31:11] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-15 15:31:11] ==================================================
[2025-12-15 15:32:15] ==================================================
[2025-12-15 15:32:15] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-15 15:32:15] ==================================================
[2025-12-15 15:32:15] Mean Return: 7.12 ± 7.62
[2025-12-15 15:32:15] Mean Completion: 55.09% ± 37.62%
[2025-12-15 15:32:15] Success Rate (full level): 24.00%
[2025-12-15 15:32:15] Mean Episode Length: 38.4
[2025-12-15 15:32:15] Per-range summary (collapsed from per-inertia):
[2025-12-15 15:32:15]   range_0:0.800-0.900: mean_return=5.08, mean_completion=41.31%, success_rate=15.09%, n_episodes=53
[2025-12-15 15:32:15]   range_1:1.100-1.200: mean_return=9.43, mean_completion=70.63%, success_rate=34.04%, n_episodes=47
[2025-12-15 15:32:15] (Per-inertia details saved in JSON: 100 values)
[2025-12-15 15:32:15] ==================================================
[2025-12-15 15:32:15] Saved final results to logs/mario_inertia_full/multi_1215_134351/seed_3/inertia_1215_150643/final_results.json
[2025-12-15 15:32:15] Model saved to logs/mario_inertia_full/multi_1215_134351/seed_3/inertia_1215_150643/final_model.zip
[2025-12-15 15:32:15] ==================================================
[2025-12-15 15:32:15] SETTING UP TRAINING
[2025-12-15 15:32:15] ==================================================
