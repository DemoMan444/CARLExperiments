[2025-12-13 22:25:05] Initialized run directory: logs/mario_inertia_quick/multi_1213_222505/seed_0/inertia_1213_222505
[2025-12-13 22:25:05] Generating training contexts (varying only mario_inertia)...
[2025-12-13 22:25:05] Training inertia resampling enabled: 2 ranges x 100 values (rotating pool)
[2025-12-13 22:25:05] Generating TEST contexts on NEW MAPS (different maps, varying mario_inertia)...
[2025-12-13 22:25:05] Using context keys in observations: ['mario_inertia']
[2025-12-13 22:25:05] Training contexts (all):
[2025-12-13 22:25:05]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 1, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 22:25:05]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 1, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 22:25:05]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 2, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 22:25:05]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 2, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 22:25:05]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 22:25:05]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 3, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 22:25:05]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 22:25:05]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 4, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 22:25:05]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 0.8500000000000001, 'train_range_index': 0}
[2025-12-13 22:25:05]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 5, 'mario_state': 0, 'mario_inertia': 1.15, 'train_range_index': 1}
[2025-12-13 22:25:05] Test contexts (all):
[2025-12-13 22:25:05]   id=0: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 22:25:05]   id=1: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 22:25:05]   id=2: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 22:25:05]   id=3: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 22:25:05]   id=4: {'level_width': 100, 'level_index': 0, 'noise_seed': 10001, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 22:25:05]   id=5: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 22:25:05]   id=6: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 22:25:05]   id=7: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 22:25:05]   id=8: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 22:25:05]   id=9: {'level_width': 100, 'level_index': 0, 'noise_seed': 10002, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 22:25:05]   id=10: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 22:25:05]   id=11: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 22:25:05]   id=12: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 22:25:05]   id=13: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 22:25:05]   id=14: {'level_width': 100, 'level_index': 0, 'noise_seed': 10003, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 22:25:05]   id=15: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 22:25:05]   id=16: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 22:25:05]   id=17: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 22:25:05]   id=18: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 22:25:05]   id=19: {'level_width': 100, 'level_index': 0, 'noise_seed': 10004, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 22:25:05]   id=20: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.6, 'gen_type': 'extra'} --> gen_type=extra, inertia=0.600
[2025-12-13 22:25:05]   id=21: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 0.85, 'gen_type': 'id'} --> gen_type=id, inertia=0.850
[2025-12-13 22:25:05]   id=22: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.0, 'gen_type': 'interp'} --> gen_type=interp, inertia=1.000
[2025-12-13 22:25:05]   id=23: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.15, 'gen_type': 'id'} --> gen_type=id, inertia=1.150
[2025-12-13 22:25:05]   id=24: {'level_width': 100, 'level_index': 0, 'noise_seed': 10005, 'mario_state': 0, 'mario_inertia': 1.4, 'gen_type': 'extra'} --> gen_type=extra, inertia=1.400
[2025-12-13 22:25:05] Test contexts by type: {'id': 10, 'interp': 5, 'extra': 10}
[2025-12-13 22:25:05] Creating 8 parallel environments...
[2025-12-13 22:25:15] Creating evaluation environment...
[2025-12-13 22:25:15] Train final eval contexts: 100 (n_inertias=100)
[2025-12-13 22:25:15] Creating PPO model...
[2025-12-13 22:25:17] Training Configuration:
[2025-12-13 22:25:17]   Train contexts: 10
[2025-12-13 22:25:17]   Test contexts: 25
[2025-12-13 22:25:17]   Parallel envs: 8
[2025-12-13 22:25:17]   Seed: 0
[2025-12-13 22:25:17]   Level width: 100
[2025-12-13 22:25:17]   Total timesteps: 50,000
[2025-12-13 22:25:17]   Device: cpu
[2025-12-13 22:25:17]   Use context in obs: True
[2025-12-13 22:25:17]   Context keys: ['mario_inertia']
[2025-12-13 22:25:17]   Feature fusion: hadamard
[2025-12-13 22:25:17]   Test on train maps: False
[2025-12-13 22:25:17]   Run Directory: logs/mario_inertia_quick/multi_1213_222505/seed_0/inertia_1213_222505
[2025-12-13 22:25:17] ==================================================
[2025-12-13 22:25:17] STARTING TRAINING
[2025-12-13 22:25:17] ==================================================
[2025-12-13 22:26:39] ----------------------------------------------------------------
[2025-12-13 22:26:39] Train @ 10,000 steps
[2025-12-13 22:26:39]   Episodes (total): 199
[2025-12-13 22:26:39]   Window(50) mean return (episode-weighted): 3.46 
[2025-12-13 22:26:39]   Window(50) mean length: 27.7
[2025-12-13 22:26:39]   Window(50) mean completion: 33.62%
[2025-12-13 22:26:39]   Uniform-per-context mean return: 2.78
[2025-12-13 22:26:39]   Uniform-per-context mean completion: 30.35%
[2025-12-13 22:26:39]   Context distribution (last 50 eps): 0:16% 1:16% 2:12% 3:12% 4:8% 5:8% 6:4% 7:6% 8:8% 9:10%
[2025-12-13 22:26:39] ----------------------------------------------------------------
[2025-12-13 22:27:38] ----------------------------------------------------------------
[2025-12-13 22:27:38] Train @ 20,000 steps
[2025-12-13 22:27:38]   Episodes (total): 567
[2025-12-13 22:27:38]   Window(50) mean return (episode-weighted): 4.46 ↑
[2025-12-13 22:27:38]   Window(50) mean length: 31.4
[2025-12-13 22:27:38]   Window(50) mean completion: 41.78%
[2025-12-13 22:27:38]   Uniform-per-context mean return: 3.57
[2025-12-13 22:27:38]   Uniform-per-context mean completion: 35.26%
[2025-12-13 22:27:38]   Context distribution (last 50 eps): 0:10% 1:10% 2:10% 3:12% 4:10% 5:8% 6:10% 7:8% 8:12% 9:10%
[2025-12-13 22:27:38] ----------------------------------------------------------------
[2025-12-13 22:28:46] ----------------------------------------------------------------
[2025-12-13 22:28:46] Train @ 30,000 steps
[2025-12-13 22:28:46]   Episodes (total): 996
[2025-12-13 22:28:46]   Window(50) mean return (episode-weighted): 5.52 ↑
[2025-12-13 22:28:46]   Window(50) mean length: 24.7
[2025-12-13 22:28:46]   Window(50) mean completion: 46.76%
[2025-12-13 22:28:46]   Uniform-per-context mean return: 4.95
[2025-12-13 22:28:46]   Uniform-per-context mean completion: 44.07%
[2025-12-13 22:28:46]   Context distribution (last 50 eps): 0:8% 1:10% 2:12% 3:12% 4:6% 5:8% 6:8% 7:10% 8:12% 9:14%
[2025-12-13 22:28:46] ----------------------------------------------------------------
[2025-12-13 22:29:55] ----------------------------------------------------------------
[2025-12-13 22:29:55] Train @ 40,000 steps
[2025-12-13 22:29:55]   Episodes (total): 1,406
[2025-12-13 22:29:55]   Window(50) mean return (episode-weighted): 5.72 ↑
[2025-12-13 22:29:55]   Window(50) mean length: 19.0
[2025-12-13 22:29:55]   Window(50) mean completion: 46.70%
[2025-12-13 22:29:55]   Uniform-per-context mean return: 5.90
[2025-12-13 22:29:55]   Uniform-per-context mean completion: 48.30%
[2025-12-13 22:29:55]   Context distribution (last 50 eps): 0:14% 1:10% 2:10% 3:8% 4:8% 5:8% 6:8% 7:10% 8:10% 9:14%
[2025-12-13 22:29:55] ----------------------------------------------------------------
[2025-12-13 22:31:26] ----------------------------------------------------------------
[2025-12-13 22:31:26] Train @ 50,000 steps
[2025-12-13 22:31:26]   Episodes (total): 1,793
[2025-12-13 22:31:26]   Window(50) mean return (episode-weighted): 7.00 ↑
[2025-12-13 22:31:26]   Window(50) mean length: 29.0
[2025-12-13 22:31:26]   Window(50) mean completion: 53.77%
[2025-12-13 22:31:26]   Uniform-per-context mean return: 5.53
[2025-12-13 22:31:26]   Uniform-per-context mean completion: 47.29%
[2025-12-13 22:31:26]   Context distribution (last 50 eps): 0:10% 1:8% 2:10% 3:8% 4:10% 5:12% 6:12% 7:10% 8:10% 9:10%
[2025-12-13 22:31:26] ----------------------------------------------------------------
[2025-12-13 22:31:47] Saved training curve to logs/mario_inertia_quick/multi_1213_222505/seed_0/inertia_1213_222505/training_curve.json
[2025-12-13 22:31:47] Saved episode history to logs/mario_inertia_quick/multi_1213_222505/seed_0/inertia_1213_222505/episode_history.json
[2025-12-13 22:31:47] ==================================================
[2025-12-13 22:31:47] FINAL EVALUATION
[2025-12-13 22:31:47] ==================================================
[2025-12-13 22:36:10] ==================================================
[2025-12-13 22:36:10] FINAL EVALUATION RESULTS [stochastic] (deterministic=False)
[2025-12-13 22:36:10] ==================================================
[2025-12-13 22:36:10] Mean Return: 5.26 ± 6.90
[2025-12-13 22:36:10] Mean Completion: 43.50% ± 33.42%
[2025-12-13 22:36:10] Success Rate (full level): 19.20%
[2025-12-13 22:36:10] Mean Episode Length: 115.6
[2025-12-13 22:36:10] Per generalization-type summary:
[2025-12-13 22:36:10]   extra: mean_return=4.10, mean_completion=36.15%, success_rate=16.00%, n_episodes=50
[2025-12-13 22:36:10]   id: mean_return=7.08, mean_completion=50.47%, success_rate=32.00%, n_episodes=50
[2025-12-13 22:36:10]   interp: mean_return=3.92, mean_completion=44.29%, success_rate=0.00%, n_episodes=25
[2025-12-13 22:36:10] Per-inertia summary:
[2025-12-13 22:36:10]   inertia=0.600: mean_return=4.68, mean_completion=33.12%, success_rate=24.00%, n_episodes=25
[2025-12-13 22:36:10]   inertia=0.850: mean_return=10.32, mean_completion=62.32%, success_rate=48.00%, n_episodes=25
[2025-12-13 22:36:10]   inertia=1.000: mean_return=3.92, mean_completion=44.29%, success_rate=0.00%, n_episodes=25
[2025-12-13 22:36:10]   inertia=1.150: mean_return=3.84, mean_completion=38.61%, success_rate=16.00%, n_episodes=25
[2025-12-13 22:36:10]   inertia=1.400: mean_return=3.52, mean_completion=39.17%, success_rate=8.00%, n_episodes=25
[2025-12-13 22:36:10] ==================================================
[2025-12-13 22:36:10] ==================================================
[2025-12-13 22:36:10] FINAL EVALUATION (TRAIN CONTEXTS)
[2025-12-13 22:36:10] ==================================================
[2025-12-13 22:37:05] ==================================================
[2025-12-13 22:37:05] FINAL EVALUATION RESULTS [train_stochastic] (deterministic=False)
[2025-12-13 22:37:05] ==================================================
[2025-12-13 22:37:05] Mean Return: 4.64 ± 5.74
[2025-12-13 22:37:05] Mean Completion: 42.39% ± 29.92%
[2025-12-13 22:37:05] Success Rate (full level): 11.00%
[2025-12-13 22:37:05] Mean Episode Length: 32.2
[2025-12-13 22:37:05] Per-range summary (collapsed from per-inertia):
[2025-12-13 22:37:05]   range_0:0.800-0.900: mean_return=3.77, mean_completion=34.09%, success_rate=8.33%, n_episodes=48
[2025-12-13 22:37:05]   range_1:1.100-1.200: mean_return=5.44, mean_completion=50.05%, success_rate=13.46%, n_episodes=52
[2025-12-13 22:37:05] (Per-inertia details saved in JSON: 100 values)
[2025-12-13 22:37:05] ==================================================
[2025-12-13 22:37:05] Saved final results to logs/mario_inertia_quick/multi_1213_222505/seed_0/inertia_1213_222505/final_results.json
[2025-12-13 22:37:05] Model saved to logs/mario_inertia_quick/multi_1213_222505/seed_0/inertia_1213_222505/final_model.zip
[2025-12-13 22:37:06] ==================================================
[2025-12-13 22:37:06] SETTING UP TRAINING
[2025-12-13 22:37:06] ==================================================
